Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:06<00:00,  3.49s/it]
<class 'datasets.arrow_dataset.Dataset'>
--> Training Set Length = 900
--> Validation Set Length = 100
The gate was not present, so initializing it!
/data/data/arrv/env/test/lib/python3.12/site-packages/torch/cuda/memory.py:343: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
  warnings.warn(
Training Epoch: 1:   0%|[34m                                                                                                                                           [0m| 0/225 [00:00<?, ?it/s][0m/data/data/arrv/ThinkTuning_v1/src/think_tuner.py:218: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
The indices are: tensor([ 0,  4,  5, 11, 12, 13, 18, 19, 20, 25, 27, 34, 35, 36, 37, 38],
       device='cuda:3')
The indices are: tensor([ 0,  4, 11, 14, 18, 19, 20, 27, 34, 35, 36, 37, 38], device='cuda:3')
The indices are: tensor([ 0,  4,  6, 20, 21, 22, 35, 36, 37, 38], device='cuda:3')
The indices are: tensor([ 0,  4, 12, 13, 19, 20, 21, 24, 28, 29, 30, 38], device='cuda:3')
The selected-indices are: [[38, 11, 4], [19, 20, 27], [0, 4, 37], [19, 13, 28]]
  sampled_token = torch.tensor(topk_indices.indices[i].unsqueeze(0)).to(device=new_sequence.device)  # Add the sampled token
torch.Size([1, 153])
torch.Size([1, 153])
torch.Size([1, 153])
torch.Size([1, 153])
torch.Size([1, 153])
torch.Size([1, 153])
torch.Size([1, 153])
torch.Size([1, 153])
torch.Size([1, 153])
torch.Size([1, 153])
torch.Size([1, 153])
torch.Size([1, 153])
Training Epoch: 1/1, step 0/225 completed (loss: 1.9375874996185303):   0%|[34mâ–Ž                                                                             [0m| 1/225 [00:16<1:03:05, 16.90s/it][0m
The indices are: tensor([  0,   1,   4,   7,   9,  10,  11,  13,  16,  18,  20,  24,  27,  40,
         44,  46,  62,  63,  67,  69,  71,  72,  78,  80,  81,  92, 100, 113,
        115, 116, 122, 126, 131, 132, 135, 141, 150, 151, 152, 154, 156, 160,
        172, 173, 187, 188, 194, 196, 197, 204, 207, 208, 211, 217, 219, 225,
        227, 230, 231, 232, 243, 244, 254, 255, 256, 269, 278, 280, 284, 286,
        291, 294, 297, 298, 312, 317, 320, 324, 328, 329], device='cuda:3')
The indices are: tensor([  0,   1,   4,   8,   9,  10,  12,  18,  20,  28,  31,  36,  37,  38,
         39,  40,  42,  44,  45,  49,  51,  52,  56,  68,  69,  73,  94,  95,
         97,  98,  99, 101, 108, 120, 180, 182, 184, 200, 268, 269, 270, 279,
        280, 281, 283, 291, 292, 294, 304, 305, 306, 308, 328, 329],
       device='cuda:3')
The indices are: tensor([  0,   1,   4,   9,  10,  18,  19,  25,  35,  36,  40,  41, 107, 125,
        126, 127, 128, 129, 158, 178, 181, 185, 191, 192, 197, 198, 231, 243,
        244, 247, 248, 259, 260, 267, 271, 283, 289, 304, 305, 328, 329],
       device='cuda:3')
The indices are: tensor([  0,   1,   4,  15,  43,  44,  48,  83,  84,  89,  90,  93,  94,  95,
         98, 102, 103, 104, 105, 109, 114, 115, 118, 121, 149, 150, 156, 159,
        161, 188, 189, 206, 207, 211, 212, 221, 222, 225, 247, 258, 263, 279,
        299, 309, 310, 329], device='cuda:3')
The selected-indices are: [[151, 1, 298], [10, 20, 1], [283, 329, 305], [299, 156, 221]]
torch.Size([1, 1022])
torch.Size([1, 1026])
torch.Size([1, 1026])
torch.Size([1, 1026])
torch.Size([1, 1026])
torch.Size([1, 1026])
torch.Size([1, 1026])
torch.Size([1, 1026])
torch.Size([1, 1026])
torch.Size([1, 1026])
torch.Size([1, 1026])
torch.Size([1, 1026])
The indices are: tensor([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,
         15,  16,  17,  18,  19,  20,  21,  26,  28,  34,  35,  36,  37,  39,
         40,  41,  43,  44,  45,  47,  48,  52,  56,  58,  63,  64,  66,  69,
         70,  71,  72,  73,  77,  79,  80,  81,  82,  84,  86,  90,  92,  93,
         94,  95,  96,  97,  98,  99, 104, 125, 126, 139, 148, 154, 158, 159,
        160, 161, 162, 171, 174, 175, 176, 177, 180, 181, 186, 187, 188, 198,
        199, 200, 203, 204, 225, 227, 231, 246, 249, 276, 282, 283, 312, 318,
        319, 321, 329, 336, 344, 352, 391, 396, 397, 398, 406, 407, 408, 409,
        410], device='cuda:3')
The indices are: tensor([  0,   1,   2,   3,   4,   6,   8,   9,  10,  11,  13,  14,  15,  16,
         19,  20,  24,  75,  77,  80,  82, 135, 136, 145, 176, 217, 223, 224,
        226, 232, 245, 246, 274, 279, 282, 303, 307, 316, 349, 385, 386, 390,
        408, 409, 410], device='cuda:3')
The indices are: tensor([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,
         14,  15,  16,  18,  20,  21,  23,  24,  26,  29,  30,  32,  33,  34,
         37,  39,  40,  42,  43,  44,  46,  47,  49,  51,  54,  55,  56,  58,
         59,  62,  66,  68,  69,  70,  71,  75,  78,  79,  81,  84,  85,  89,
         90,  99, 102, 110, 114, 116, 117, 124, 143, 144, 146, 148, 149, 153,
        155, 156, 161, 163, 171, 172, 174, 175, 177, 185, 186, 190, 191, 192,
        196, 199, 223, 224, 225, 228, 230, 231, 250, 253, 256, 264, 266, 268,
        269, 282, 294, 298, 303, 304, 307, 308, 313, 325, 326, 329, 334, 335,
        344, 367, 375, 389, 390, 391, 394, 400, 408, 409, 410],
       device='cuda:3')
The indices are: tensor([  0,   1,   2,   3,   4,   5,   8,   9,  10,  12,  15,  16,  23,  32,
         34,  35,  36,  41,  44,  49,  51,  52,  59,  61,  68,  74,  76,  77,
         78,  79,  81,  84,  87,  89,  96,  98, 112, 119, 125, 126, 135, 137,
        144, 145, 146, 154, 155, 169, 182, 184, 192, 197, 201, 202, 205, 226,
        229, 243, 245, 247, 254, 259, 273, 277, 279, 314, 315, 316, 319, 338,
        347, 359, 364, 367, 368, 376, 394, 398, 410], device='cuda:3')
The selected-indices are: [[82, 7, 148], [390, 145, 4], [32, 7, 307], [364, 12, 367]]
torch.Size([1, 1269])
torch.Size([1, 1269])
torch.Size([1, 1269])
torch.Size([1, 1269])
torch.Size([1, 1269])
torch.Size([1, 1268])
torch.Size([1, 1269])
torch.Size([1, 1269])
torch.Size([1, 1269])
torch.Size([1, 1269])
torch.Size([1, 1269])
torch.Size([1, 1269])
The indices are: tensor([  1,   2,   3,   4,   5,   6,   7,  10,  11,  12,  13,  15,  17,  18,
         19,  20,  28,  29,  30,  32,  34,  40,  46,  50,  51,  52,  55,  57,
         58,  59,  61,  69,  73,  74,  79,  80,  94,  97,  99, 101, 121, 124,
        129, 130, 138, 141, 142, 143, 156, 157, 163, 166, 168, 171],
       device='cuda:3')
The indices are: tensor([  1,   2,   3,   4,   5,   6,   7,   8,   9,  14,  15,  16,  17,  18,
         21,  22,  23,  25,  26,  27,  32,  33,  40,  44,  45,  50,  51,  52,
         53,  55,  57,  58,  59,  62,  63,  64,  65,  66,  67,  75,  77,  78,
         81, 105, 106, 119, 120, 139, 140, 151, 153, 158, 161, 162, 171],
       device='cuda:3')
The indices are: tensor([  1,   2,   3,   4,   5,   6,   7,   9,  16,  24,  43,  45,  53,  54,
         55,  58,  60,  61,  84,  85,  88,  89, 108, 129, 133, 152, 156, 171],
       device='cuda:3')
The indices are: tensor([  1,   2,   3,   4,   5,   8,   9,  10,  11,  12,  13,  18,  19,  20,
         22,  30,  32,  36,  39,  40,  49,  50,  51,  52,  54,  55,  56,  59,
         62,  63,  64,  66,  67,  68,  76,  79,  88,  93, 105, 106, 109, 127,
        141, 151, 158, 159, 171], device='cuda:3')
The selected-indices are: [[94, 3, 40], [105, 1, 139], [9, 7, 4], [63, 66, 59]]
torch.Size([1, 552])
torch.Size([1, 552])
torch.Size([1, 552])
torch.Size([1, 552])
torch.Size([1, 552])
torch.Size([1, 544])
torch.Size([1, 552])
torch.Size([1, 552])
torch.Size([1, 552])
torch.Size([1, 552])
torch.Size([1, 552])
torch.Size([1, 552])
The indices are: tensor([  1,   2,   4,   5,  11,  13,  17,  18,  19,  21,  22,  23,  30,  54,
         55,  56,  59,  63, 132, 146, 211, 214, 221, 284, 304, 305],
       device='cuda:3')
The indices are: tensor([  1,   2,   4,   7,   8,   9,  10,  11,  12,  13,  15,  29,  30,  40,
         42,  43,  48,  50,  55,  56,  57,  60,  62,  64,  65,  72,  73,  74,
         76,  78,  79,  80,  85,  86,  87,  88,  89,  90,  92, 101, 103, 104,
        107, 108, 109, 113, 116, 121, 122, 125, 126, 127, 138, 139, 141, 145,
        148, 164, 166, 175, 176, 177, 179, 180, 217, 218, 222, 231, 252, 255,
        257, 269, 270, 272, 281, 291, 293, 304, 305], device='cuda:3')
The indices are: tensor([  1,   2,   4,   5,   8,  17,  18,  21,  22,  26,  27,  28,  29,  30,
         31,  32,  36,  38,  41,  42,  43,  47,  48,  57,  60,  68,  69,  70,
         73,  74,  75,  77,  86,  92,  93,  96, 101, 105, 119, 135, 143, 161,
        172, 189, 192, 195, 196, 219, 251, 262, 263, 267, 296, 299, 301, 304,
        305], device='cuda:3')
The indices are: tensor([  1,   2,   4,   5,   8,  11,  13,  26,  27,  28,  30,  31,  33,  34,
         35,  39,  40,  45,  46,  50,  51,  52,  55,  57,  60,  61,  62,  68,
         72,  76,  82,  83,  84,  98, 105, 107, 108, 109, 112, 114, 117, 125,
        127, 131, 138, 139, 140, 141, 143, 144, 146, 149, 151, 152, 154, 155,
        189, 190, 191, 196, 202, 204, 207, 208, 211, 215, 217, 220, 222, 231,
        233, 236, 238, 248, 251, 268, 271, 273, 275, 279, 287, 289, 305],
       device='cuda:3')
The selected-indices are: [[132, 211, 30], [60, 252, 8], [30, 93, 161], [211, 35, 83]]
torch.Size([1, 954])
torch.Size([1, 954])
torch.Size([1, 954])
torch.Size([1, 954])
torch.Size([1, 954])
torch.Size([1, 954])
torch.Size([1, 954])
torch.Size([1, 954])
torch.Size([1, 954])
torch.Size([1, 954])
torch.Size([1, 954])
torch.Size([1, 954])
The indices are: tensor([  1,   4,   7,  16,  29,  30,  35,  40,  48,  49,  87,  89,  92,  94,
        107, 131, 140, 154, 155, 157, 158, 159, 166, 175, 181, 182, 187, 195,
        196, 197, 198, 199, 208, 224, 226, 227, 228, 239, 241, 249, 260, 277,
        282, 283, 289, 291, 303, 304, 312, 337, 338, 346, 363, 367, 377, 380,
        384, 385, 389, 413, 414, 415, 417, 421, 426, 441, 450, 458, 459, 460,
        470, 491, 504, 509, 517, 518, 519, 522, 536, 541, 556, 557, 578, 587,
        588, 592, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621,
        622, 623], device='cuda:3')
The indices are: tensor([  1,   4,   7,   8,   9,  17,  18,  19,  20,  21,  22,  23,  24,  25,
         29,  30,  39,  42,  44,  47,  50,  57,  58,  60,  63,  64,  69,  70,
         71,  73,  74,  75,  76,  77,  78,  81,  82,  85,  86,  88,  89,  90,
         91,  94,  95,  98, 102, 103, 105, 115, 122, 124, 126, 133, 135, 138,
        141, 142, 144, 145, 148, 152, 158, 177, 178, 179, 188, 194, 198, 199,
        204, 211, 217, 218, 219, 220, 226, 252, 253, 262, 263, 264, 266, 275,
        280, 283, 299, 303, 304, 305, 312, 314, 323, 331, 339, 340, 342, 344,
        345, 351, 354, 358, 360, 367, 369, 370, 372, 373, 376, 378, 384, 385,
        396, 397, 404, 405, 415, 417, 422, 432, 433, 434, 445, 448, 467, 470,
        483, 501, 509, 510, 515, 518, 528, 531, 539, 548, 555, 580, 584, 592,
        609, 610, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623],
       device='cuda:3')
The indices are: tensor([  1,   4,   7,   8,   9,  10,  11,  12,  16,  20,  21,  27,  29,  32,
         33,  35,  36,  37,  38,  39,  43,  52,  53,  55,  56,  58,  64,  65,
         66,  69,  70,  72,  74,  76,  85,  86,  88,  96,  97,  98, 101, 103,
        105, 122, 125, 126, 128, 131, 143, 155, 167, 172, 176, 179, 181, 188,
        191, 195, 197, 201, 204, 205, 207, 211, 214, 226, 229, 231, 234, 249,
        252, 257, 260, 261, 263, 268, 269, 271, 272, 276, 336, 339, 375, 378,
        379, 380, 384, 411, 416, 422, 426, 438, 441, 453, 455, 456, 471, 480,
        481, 487, 490, 505, 516, 519, 525, 528, 533, 539, 543, 547, 550, 551,
        565, 579, 580, 582, 587, 594, 597, 620, 621, 622, 623],
       device='cuda:3')
The indices are: tensor([  1,   4,   6,   7,   8,   9,  10,  11,  12,  13,  14,  18,  19,  20,
         23,  25,  26,  27,  28,  31,  33,  36,  38,  39,  40,  52,  53,  54,
         55,  58,  60,  67,  68,  69,  72,  73,  74,  77,  80,  81,  82,  83,
         84,  85,  86,  88,  90,  92,  93,  95,  96,  97,  98, 102, 103, 105,
        108, 109, 110, 113, 118, 119, 120, 126, 127, 131, 134, 136, 137, 139,
        147, 148, 152, 160, 163, 164, 165, 171, 177, 185, 188, 189, 190, 191,
        197, 198, 200, 205, 207, 208, 209, 210, 211, 213, 215, 216, 217, 223,
        224, 225, 226, 229, 235, 236, 240, 241, 243, 244, 247, 248, 253, 262,
        264, 265, 266, 268, 283, 284, 288, 295, 296, 297, 299, 303, 304, 305,
        308, 309, 315, 316, 317, 319, 323, 332, 335, 348, 354, 355, 356, 358,
        363, 370, 373, 375, 377, 378, 384, 386, 387, 390, 391, 392, 394, 395,
        396, 399, 400, 406, 408, 409, 410, 412, 413, 414, 415, 416, 422, 434,
        435, 442, 445, 446, 447, 454, 463, 464, 470, 471, 479, 485, 487, 491,
        494, 501, 510, 512, 525, 533, 535, 536, 537, 539, 541, 547, 551, 552,
        554, 555, 556, 558, 559, 560, 564, 565, 572, 573, 575, 576, 577, 579,
        580, 581, 584, 593, 595, 596, 597, 599, 600, 601, 605, 609, 618, 623],
       device='cuda:3')
The selected-indices are: [[504, 48, 40], [354, 433, 404], [125, 105, 481], [81, 487, 127]]
torch.Size([1, 1908])
torch.Size([1, 1908])
torch.Size([1, 1908])
torch.Size([1, 1908])
torch.Size([1, 1908])
torch.Size([1, 1908])
torch.Size([1, 1908])
torch.Size([1, 1908])
torch.Size([1, 1908])
torch.Size([1, 1908])
torch.Size([1, 1908])
torch.Size([1, 1908])
The indices are: tensor([  1,   2,   4,   5,   6,   7,   8,   9,  10,  12,  18,  19,  20,  22,
         26,  29,  30,  33,  34,  43,  45,  48,  68,  79,  80,  84,  86,  89,
         91,  98, 100, 101, 102, 111, 115, 116, 126, 131, 134, 137, 142, 168,
        169, 185, 188, 196, 217, 222, 244, 245, 247, 248, 249, 250, 255, 256,
        277, 278, 285, 295, 307, 330, 331, 332], device='cuda:3')
The indices are: tensor([  1,   2,   4,   5,   6,   7,   8,   9,  10,  12,  55,  71,  73,  76,
         78,  80,  89, 123, 124, 153, 157, 159, 167, 180, 213, 222, 231, 238,
        244, 250, 292, 300, 301, 305, 310, 331, 332], device='cuda:3')
The indices are: tensor([  1,   2,   4,  10,  11,  12,  15,  18,  19,  20,  22,  23,  24,  28,
         29,  30,  31,  32,  35,  38,  39,  41,  42,  45,  46,  47,  50,  53,
         56,  57,  65,  66,  68,  69,  70,  72,  74,  75,  77,  80,  82,  83,
         84,  85,  89,  95,  97, 101, 102, 113, 114, 115, 120, 124, 147, 159,
        167, 168, 175, 176, 190, 198, 209, 214, 219, 222, 223, 226, 235, 237,
        254, 258, 270, 273, 274, 277, 286, 289, 301, 304, 305, 308, 314, 320,
        321, 327, 328, 331, 332], device='cuda:3')
The indices are: tensor([  1,   2,   4,   5,   7,  15,  17,  19,  25,  26,  32,  38,  52,  53,
         58,  60,  63,  65,  70,  71,  72,  73,  74,  75,  76,  79,  82,  89,
         99, 105, 107, 114, 119, 127, 128, 130, 132, 136, 138, 141, 154, 155,
        158, 173, 175, 185, 200, 201, 202, 239, 249, 253, 255, 272, 285, 288,
        291, 292, 295, 296, 298, 307, 310, 314, 332], device='cuda:3')
The selected-indices are: [[126, 245, 332], [231, 89, 305], [175, 30, 219], [52, 82, 175]]
torch.Size([1, 1035])
torch.Size([1, 1035])
torch.Size([1, 1035])
torch.Size([1, 1035])
torch.Size([1, 1035])
torch.Size([1, 1035])
torch.Size([1, 1035])
torch.Size([1, 1035])
torch.Size([1, 1035])
torch.Size([1, 1035])
torch.Size([1, 1035])
torch.Size([1, 1035])
The indices are: tensor([  1,   2,   4,   6,   9,  10,  13,  15,  16,  17,  18,  19,  20,  25,
         26,  28,  29,  34,  35,  36,  39,  41,  42,  43,  44,  49,  56,  57,
         64,  66,  67,  68,  69,  70,  85,  87,  88,  92,  94,  97, 101, 113,
        114, 116, 121, 123, 124, 126, 127, 128, 130, 131, 133, 135, 138, 139,
        143, 144, 148, 155, 156, 161, 162, 167, 178, 183, 190, 191, 196, 210,
        232, 236, 237, 241, 283, 289, 293, 299, 301, 302, 306, 308, 309, 310,
        312, 313, 314, 315, 316, 317, 319, 322, 326, 333, 342, 348, 349, 356,
        358, 359, 362, 365, 368, 373, 376, 379, 381, 383, 395, 401, 404, 408,
        419, 433, 435, 453, 462, 471, 488, 497, 502, 517, 519, 520, 528, 529,
        530, 531, 532, 533, 534, 535, 536], device='cuda:3')
The indices are: tensor([  1,   2,   4,   5,   6,   9,  10,  11,  12,  21,  23,  38,  40,  56,
         76,  84,  86,  89,  91,  94, 103, 118, 132, 133, 139, 145, 151, 155,
        177, 178, 182, 184, 188, 216, 224, 225, 248, 254, 255, 258, 259, 270,
        275, 288, 293, 307, 313, 318, 321, 355, 364, 369, 372, 381, 384, 388,
        389, 391, 394, 411, 414, 418, 422, 432, 434, 435, 450, 460, 463, 469,
        472, 481, 483, 487, 492, 494, 496, 498, 502, 503, 506, 508, 514, 529,
        530, 531, 532, 533, 534, 535, 536], device='cuda:3')
The indices are: tensor([  1,   2,   4,   5,  12,  13,  17,  20,  24,  33,  34,  35,  36,  37,
         38,  48,  52,  54,  57,  62,  77,  79,  80,  94, 100, 101, 102, 117,
        128, 130, 136, 138, 141, 142, 143, 148, 149, 151, 152, 158, 170, 185,
        202, 214, 229, 230, 233, 238, 246, 270, 273, 317, 323, 327, 337, 345,
        482, 483, 503, 513, 521, 533, 534, 535, 536], device='cuda:3')
The indices are: tensor([  1,   2,   4,   8,   9,  10,  12,  22,  23,  24,  25,  26,  27,  28,
         31,  33,  35,  36,  41,  43,  46,  48,  51,  53,  54,  55,  69,  70,
         77,  78,  79,  80,  81,  83,  86,  90,  92,  93,  94,  95, 100, 107,
        126, 127, 128, 129, 131, 133, 134, 139, 140, 147, 159, 160, 162, 164,
        170, 173, 218, 222, 229, 233, 237, 247, 252, 253, 254, 255, 258, 259,
        263, 265, 268, 271, 274, 278, 281, 287, 288, 295, 296, 297, 303, 305,
        306, 308, 311, 317, 323, 329, 331, 339, 348, 368, 372, 381, 391, 392,
        399, 404, 409, 415, 417, 425, 430, 445, 464, 467, 472, 475, 490, 494,
        506, 508, 509, 520, 524, 536], device='cuda:3')
The selected-indices are: [[237, 128, 306], [418, 177, 496], [214, 158, 151], [311, 229, 77]]
torch.Size([1, 1647])
torch.Size([1, 1647])
torch.Size([1, 1647])
torch.Size([1, 1647])
torch.Size([1, 1647])
torch.Size([1, 1647])
torch.Size([1, 1647])
torch.Size([1, 1647])
torch.Size([1, 1647])
torch.Size([1, 1647])
torch.Size([1, 1647])
torch.Size([1, 1647])
The indices are: tensor([  1,   2,   6,   7,   8,   9,  15,  17,  27,  29,  32,  33,  36,  37,
         40,  42,  45,  47,  49,  50,  53,  60,  66,  68,  75,  76,  77,  90,
         99, 100, 107, 115, 118, 123, 125, 128, 148, 150, 158, 160, 163, 169,
        177, 185, 186], device='cuda:3')
The indices are: tensor([  1,   2,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,  15,  16,
         17,  18,  21,  22,  23,  24,  25,  26,  27,  31,  33,  34,  38,  39,
         40,  42,  43,  46,  47,  48,  51,  52,  53,  54,  56,  57,  58,  59,
         62,  63,  64,  66,  68,  69,  71,  72,  75,  76,  77,  78,  79,  80,
         81,  82,  86,  87,  89,  91,  92,  94,  96,  97,  99, 100, 101, 104,
        107, 108, 110, 111, 112, 113, 115, 116, 117, 119, 122, 125, 127, 135,
        137, 138, 149, 150, 154, 158, 159, 164, 173, 175, 180, 182, 185, 186],
       device='cuda:3')
The indices are: tensor([  1,   2,   8,   9,  10,  11,  12,  13,  14,  16,  17,  18,  19,  27,
         28,  30,  31,  32,  33,  38,  39,  40,  43,  46,  47,  49,  50,  54,
         57,  58,  59,  60,  61,  62,  63,  64,  65,  67,  68,  70,  72,  73,
         75,  76,  77,  89,  91,  93,  96,  99, 100, 101, 106, 107, 109, 128,
        133, 134, 135, 137, 138, 140, 144, 146, 147, 149, 150, 154, 158, 160,
        162, 163, 165, 168, 173, 174, 185, 186], device='cuda:3')
The indices are: tensor([  1,   2,   6,   7,   8,   9,  12,  14,  18,  19,  24,  25,  27,  28,
         34,  38,  39,  40,  43,  45,  46,  48,  49,  50,  61,  62,  65,  66,
         67,  70,  71,  80,  81,  82,  88,  91, 102, 105, 111, 116, 117, 119,
        120, 122, 135, 137, 138, 141, 146, 158, 159, 161, 162, 163, 168, 175,
        182, 183, 186], device='cuda:3')
The selected-indices are: [[37, 8, 77], [10, 164, 185], [10, 100, 133], [120, 24, 1]]
torch.Size([1, 597])
torch.Size([1, 597])
torch.Size([1, 597])
torch.Size([1, 597])
torch.Size([1, 597])
torch.Size([1, 597])
torch.Size([1, 597])
torch.Size([1, 597])
torch.Size([1, 597])
torch.Size([1, 597])
torch.Size([1, 597])
torch.Size([1, 597])
The indices are: tensor([ 1,  2,  4,  5,  6,  7,  8,  9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 22,
        23, 24, 25, 26, 29, 30, 31, 32, 37, 38, 40, 41, 42, 44, 45, 46, 48, 55,
        56, 57, 60, 62, 63, 64, 65, 66, 75, 79, 88, 92, 93, 94],
       device='cuda:3')
The indices are: tensor([ 1,  2,  4,  5,  7,  9, 10, 11, 16, 18, 21, 23, 24, 25, 27, 28, 31, 32,
        33, 34, 35, 36, 37, 38, 39, 40, 43, 44, 45, 46, 47, 51, 55, 59, 60, 70,
        73, 74, 76, 77, 78, 79, 80, 82, 83, 84, 85, 86, 87, 88, 89, 93, 94],
       device='cuda:3')
The indices are: tensor([ 1,  2,  4,  8, 13, 22, 24, 36, 38, 41, 42, 45, 58, 62, 65, 73, 76, 93,
        94], device='cuda:3')
The indices are: tensor([ 1,  2,  4,  5,  6,  7,  8, 10, 14, 15, 17, 18, 19, 20, 21, 22, 24, 27,
        28, 40, 41, 42, 45, 46, 47, 48, 49, 51, 56, 58, 59, 61, 64, 65, 66, 67,
        73, 81, 82, 94], device='cuda:3')
The selected-indices are: [[46, 65, 75], [1, 60, 38], [2, 62, 13], [45, 10, 19]]
torch.Size([1, 321])
torch.Size([1, 321])
torch.Size([1, 321])
torch.Size([1, 321])
torch.Size([1, 321])
torch.Size([1, 321])
torch.Size([1, 321])
torch.Size([1, 321])
torch.Size([1, 321])
torch.Size([1, 321])
torch.Size([1, 321])
torch.Size([1, 321])
The indices are: tensor([  1,   4,   5,   7,   8,   9,  10,  11,  12,  13,  14,  15,  16,  17,
         18,  20,  21,  22,  23,  24,  26,  29,  32,  36,  43,  45,  48,  51,
         53,  54,  55,  59,  60,  62,  63,  65,  66,  67,  71,  72,  73,  75,
         76,  78,  79,  80,  81,  87,  88,  90,  91,  92,  93,  94,  96,  97,
        100, 101, 102, 103, 105, 106, 107, 108, 109, 110, 113, 118, 119, 120,
        121, 126, 127, 130, 134, 135, 136, 139, 145, 150, 154, 157, 158, 159,
        165, 177, 187, 188, 194, 195, 197, 198, 199, 201, 202, 210, 211, 221,
        223, 224, 226, 235, 242, 244, 245, 251, 253, 254, 255, 256, 257, 260,
        262, 263, 264, 265, 266, 272, 274, 276, 277, 287, 288, 296, 305, 308,
        309, 320, 321, 323, 326, 330, 336, 339, 342, 352, 353],
       device='cuda:3')
The indices are: tensor([  1,   4,   6,   8,   9,  10,  12,  13,  15,  18,  21,  23,  24,  26,
         27,  30,  31,  33,  37,  40,  41,  43,  49,  50,  51,  54,  55,  56,
         58,  62,  65,  68,  69,  73,  74,  75,  76,  77,  79,  80,  83,  84,
         88,  90,  92,  94,  96,  97,  98,  99, 100, 103, 107, 108, 109, 110,
        111, 112, 113, 114, 115, 116, 118, 119, 120, 121, 127, 134, 138, 139,
        144, 146, 147, 148, 150, 151, 153, 160, 161, 162, 164, 171, 172, 174,
        175, 178, 179, 187, 190, 196, 203, 209, 210, 211, 212, 213, 216, 217,
        219, 220, 222, 223, 228, 236, 242, 243, 247, 250, 254, 255, 257, 258,
        259, 260, 261, 262, 264, 265, 266, 274, 285, 288, 289, 290, 291, 292,
        294, 295, 297, 298, 304, 305, 306, 307, 309, 310, 311, 312, 314, 315,
        316, 317, 319, 324, 326, 327, 328, 329, 331, 334, 335, 346, 352, 353],
       device='cuda:3')
The indices are: tensor([  1,   4,   5,   6,  11,  13,  14,  15,  17,  20,  21,  23,  24,  25,
         29,  32,  34,  35,  37,  38,  40,  44,  45,  47,  49,  50,  56,  58,
         61,  64,  66,  67,  71,  74,  76,  77,  79,  83,  86,  87,  88,  92,
         99, 100, 101, 103, 109, 110, 114, 115, 116, 123, 127, 128, 129, 133,
        145, 146, 147, 150, 151, 152, 157, 159, 183, 190, 194, 195, 196, 202,
        205, 211, 215, 219, 220, 222, 225, 226, 227, 228, 233, 237, 239, 243,
        245, 252, 258, 261, 264, 265, 270, 276, 278, 279, 289, 293, 294, 300,
        303, 304, 305, 310, 319, 332, 333, 349, 350, 353], device='cuda:3')
The indices are: tensor([  1,   4,   5,   6,   7,   8,   9,  10,  13,  17,  21,  31,  39,  40,
         43,  44,  45,  46,  47,  48,  51,  53,  56,  58,  60,  63,  64,  66,
         69,  70,  71,  72,  75,  79,  80,  88,  91,  92,  95,  99, 101, 102,
        103, 104, 114, 116, 117, 118, 123, 126, 127, 133, 134, 141, 142, 147,
        148, 151, 153, 158, 162, 166, 167, 168, 169, 172, 184, 185, 186, 187,
        190, 191, 194, 196, 200, 201, 205, 207, 211, 212, 215, 220, 221, 224,
        226, 234, 235, 237, 238, 242, 243, 262, 263, 266, 268, 270, 271, 273,
        274, 275, 282, 283, 284, 285, 286, 287, 289, 290, 295, 298, 303, 304,
        309, 319, 322, 324, 328, 330, 331, 335, 336, 342, 343, 353],
       device='cuda:3')
The selected-indices are: [[150, 177, 257], [265, 8, 113], [5, 45, 319], [336, 268, 186]]
torch.Size([1, 1098])
torch.Size([1, 1098])
torch.Size([1, 1098])
torch.Size([1, 1098])
torch.Size([1, 1098])
torch.Size([1, 1098])
torch.Size([1, 1098])
torch.Size([1, 1098])
torch.Size([1, 1098])
torch.Size([1, 1098])
torch.Size([1, 1098])
torch.Size([1, 1098])
The indices are: tensor([  1,   2,   4,   5,   6,   7,   8,   9,  10,  11,  12,  14,  15,  17,
         18,  20,  22,  24,  25,  26,  27,  28,  31,  32,  33,  35,  36,  38,
         42,  45,  46,  48,  49,  51,  53,  57,  58,  59,  62,  63,  64,  65,
         66,  67,  68,  74,  75,  77,  78,  79,  80,  81,  84,  88,  97,  98,
         99, 101, 102, 103, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114,
        115, 116, 118, 121, 123, 124, 127, 128, 129, 132, 133, 134, 142, 143,
        154, 161, 164, 165, 168, 169, 176, 180, 181, 182, 183, 184, 189, 193,
        194, 195, 196, 199, 201, 202, 205, 210, 216, 217, 220, 221],
       device='cuda:3')
The indices are: tensor([  1,   2,   4,   5,   6,   7,   9,  10,  11,  12,  13,  14,  15,  19,
         20,  22,  23,  26,  30,  31,  32,  35,  36,  38,  39,  43,  45,  46,
         50,  51,  52,  54,  55,  56,  57,  59,  63,  64,  65,  68,  70,  71,
         74,  77,  78,  79,  81,  82,  84,  85,  91,  92,  97,  98, 103, 104,
        105, 106, 107, 108, 120, 121, 125, 126, 130, 135, 139, 144, 147, 148,
        150, 151, 152, 154, 157, 159, 160, 161, 165, 177, 178, 181, 185, 186,
        190, 191, 192, 194, 198, 199, 203, 207, 208, 211, 213, 216, 217, 220,
        221], device='cuda:3')
The indices are: tensor([  1,   2,   4,   5,   7,   8,   9,  10,  11,  13,  14,  15,  16,  17,
         18,  26,  33,  34,  35,  36,  37,  38,  39,  43,  45,  48,  51,  52,
         54,  55,  56,  57,  60,  68,  71,  81,  83,  86,  87,  89,  90,  92,
         93,  94,  95,  96,  97,  98,  99, 100, 103, 104, 107, 108, 113, 115,
        116, 117, 119, 124, 128, 133, 143, 145, 152, 153, 155, 156, 157, 160,
        161, 163, 164, 165, 170, 171, 172, 175, 188, 190, 196, 199, 202, 205,
        206, 213, 216, 217, 220, 221], device='cuda:3')
The indices are: tensor([  1,   2,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,  15,
         17,  19,  20,  21,  22,  26,  27,  29,  30,  32,  34,  41,  43,  44,
         46,  49,  54,  55,  56,  61,  67,  70,  76,  78,  81,  91,  97, 105,
        106, 107, 108, 115, 118, 119, 124, 127, 132, 133, 141, 149, 151, 153,
        154, 161, 166, 167, 168, 172, 173, 179, 181, 189, 196, 199, 212, 216,
        217, 221], device='cuda:3')
The selected-indices are: [[202, 201, 103], [7, 126, 98], [93, 117, 145], [19, 32, 12]]
torch.Size([1, 702])
torch.Size([1, 702])
torch.Size([1, 702])
torch.Size([1, 702])
torch.Size([1, 702])
torch.Size([1, 702])
torch.Size([1, 702])
torch.Size([1, 702])
torch.Size([1, 702])
torch.Size([1, 702])
torch.Size([1, 702])
torch.Size([1, 702])
The indices are: tensor([  1,   4,   5,   7,   8,   9,  10,  11,  13,  14,  15,  16,  17,  18,
         19,  20,  21,  24,  27,  31,  35,  37,  40,  43,  45,  46,  47,  49,
         57,  66,  67,  68,  69,  72,  73,  77,  82,  84,  85,  87,  88,  89,
         92,  93,  94,  95,  99, 100, 104, 106, 107, 108, 110, 111, 112, 116,
        119, 120, 121, 123, 125, 126, 127, 128, 130, 131, 133, 134, 135, 137,
        138, 143, 144, 145, 146, 147, 148, 149, 150, 152, 153, 155, 159, 160,
        161, 164, 166, 168, 169, 172, 176, 178, 184, 186, 188, 189, 194, 202,
        204, 205, 207, 208, 210, 211, 212, 213, 214, 220, 221, 222, 226, 227,
        228, 229, 230, 231, 242, 247, 253, 256, 257, 258, 259, 262, 264, 266,
        268, 269, 270, 271, 274, 275, 276, 278, 279, 280, 282, 286, 287, 288,
        289, 290, 293, 294, 295, 297, 298, 299, 304, 305, 306, 310, 311, 313,
        324, 326, 328, 329, 330, 331, 335, 336, 338, 341, 342, 352, 354, 358,
        363, 366, 373, 374, 375], device='cuda:3')
The indices are: tensor([  1,   4,   5,   7,  11,  12,  13,  14,  15,  16,  18,  19,  21,  25,
         28,  29,  31,  32,  33,  38,  41,  43,  47,  48,  50,  51,  53,  55,
         56,  58,  59,  66,  70,  71,  72,  75,  82,  84,  90,  93,  94, 100,
        103, 104, 105, 106, 110, 112, 115, 116, 117, 118, 119, 120, 122, 123,
        126, 127, 129, 130, 138, 139, 144, 148, 149, 150, 151, 158, 161, 164,
        165, 174, 176, 177, 179, 180, 181, 183, 184, 185, 191, 196, 199, 201,
        203, 204, 207, 215, 218, 220, 223, 224, 228, 238, 239, 242, 243, 245,
        253, 261, 265, 266, 272, 277, 278, 279, 280, 282, 283, 285, 291, 293,
        303, 304, 319, 320, 329, 330, 332, 333, 337, 342, 350, 353, 356, 357,
        365, 370, 371, 374, 375], device='cuda:3')
The indices are: tensor([  1,   4,   5,   7,   8,   9,  10,  11,  13,  14,  15,  16,  20,  21,
         22,  23,  31,  35,  38,  39,  41,  42,  44,  47,  48,  50,  51,  62,
         65,  66,  70,  72,  75,  76,  79,  85,  92,  95,  96,  99, 100, 102,
        106, 108, 109, 111, 115, 117, 120, 122, 123, 124, 125, 126, 127, 128,
        129, 130, 138, 139, 141, 148, 151, 161, 164, 165, 179, 182, 183, 184,
        186, 187, 194, 195, 205, 212, 213, 217, 221, 223, 224, 226, 230, 231,
        232, 243, 244, 246, 249, 251, 254, 255, 257, 263, 266, 267, 269, 279,
        281, 286, 289, 290, 292, 301, 315, 316, 320, 325, 327, 332, 333, 338,
        345, 349, 350, 364, 367, 375], device='cuda:3')
The indices are: tensor([  1,   4,   5,   6,   7,   8,   9,  10,  11,  12,  14,  17,  18,  19,
         20,  21,  22,  23,  24,  25,  28,  31,  32,  33,  34,  35,  36,  37,
         38,  39,  41,  42,  43,  45,  49,  50,  54,  55,  57,  59,  66,  67,
         69,  70,  74,  77,  78,  79,  84,  86,  89,  99, 101, 104, 116, 118,
        120, 121, 122, 126, 130, 132, 133, 135, 137, 138, 142, 143, 145, 146,
        147, 149, 150, 151, 152, 153, 154, 155, 156, 157, 159, 160, 161, 162,
        166, 171, 172, 186, 191, 192, 194, 195, 197, 208, 209, 210, 212, 215,
        219, 220, 221, 228, 229, 246, 248, 255, 259, 262, 269, 270, 276, 277,
        278, 281, 288, 289, 292, 305, 311, 312, 319, 333, 340, 342, 345, 346,
        351, 352, 363, 364, 375], device='cuda:3')
The selected-indices are: [[306, 208, 287], [82, 161, 47], [338, 349, 16], [23, 24, 255]]
torch.Size([1, 1164])
torch.Size([1, 1164])
torch.Size([1, 1164])
torch.Size([1, 1164])
torch.Size([1, 1164])
torch.Size([1, 1164])
torch.Size([1, 1164])
torch.Size([1, 1164])
torch.Size([1, 1164])
torch.Size([1, 1164])
torch.Size([1, 1164])
torch.Size([1, 1164])
The indices are: tensor([  1,   4,   5,   7,  63,  71,  73,  76,  78,  81,  82,  88,  99, 100,
        102, 103, 106, 109, 110, 120, 123, 125, 130, 131, 135, 136, 155, 163,
        167, 168, 187, 193, 194, 195, 199, 212, 218, 224, 231, 241, 242, 247,
        249, 254, 259, 264, 267, 268, 282], device='cuda:3')
The indices are: tensor([  1,   4,   5,   6,   7,  10,  11,  12,  13,  14,  18,  20,  22,  25,
         27,  28,  29,  30,  33,  38,  40,  48,  50,  51,  54,  58,  59,  60,
         63,  75,  80,  86,  89,  90,  91, 100, 101, 102, 103, 106, 122, 124,
        125, 152, 155, 158, 159, 162, 163, 164, 165, 166, 168, 169, 181, 182,
        184, 193, 194, 213, 214, 215, 223, 229, 240, 244, 246, 247, 269, 282],
       device='cuda:3')
The indices are: tensor([  1,   4,   5,   6,  10,  11,  13,  14,  15,  16,  18,  19,  21,  24,
         27,  28,  30,  31,  32,  33,  35,  36,  38,  42,  43,  44,  47,  48,
         49,  50,  53,  56,  57,  58,  65,  66,  69,  71,  72,  73,  74,  75,
         78,  87,  89,  93,  95,  96,  99, 100, 101, 103, 104, 105, 107, 108,
        110, 111, 112, 113, 128, 129, 134, 138, 139, 142, 143, 144, 145, 148,
        152, 154, 155, 160, 161, 164, 166, 170, 174, 175, 177, 182, 184, 185,
        193, 194, 196, 197, 198, 200, 201, 218, 219, 224, 225, 227, 228, 229,
        230, 231, 232, 233, 234, 235, 236, 237, 240, 244, 245, 246, 250, 255,
        256, 258, 259, 260, 261, 262, 264, 265, 278, 279, 282],
       device='cuda:3')
The indices are: tensor([  1,   4,   5,   8,  13,  16,  26,  27,  28,  29,  30,  31,  32,  33,
         34,  35,  36,  38,  39,  43,  44,  46,  51,  52,  54,  55,  56,  60,
         61,  62,  65,  71,  72,  74,  78,  79,  80,  81,  82,  83,  84,  91,
         96,  99, 101, 104, 114, 117, 118, 124, 125, 133, 139, 140, 142, 145,
        151, 160, 161, 166, 174, 178, 184, 185, 189, 196, 204, 211, 220, 221,
        229, 233, 234, 237, 238, 246, 252, 257, 258, 269, 274, 282],
       device='cuda:3')
The selected-indices are: [[168, 103, 63], [59, 29, 269], [33, 27, 201], [79, 8, 46]]
torch.Size([1, 885])
torch.Size([1, 885])
torch.Size([1, 885])
torch.Size([1, 885])
torch.Size([1, 885])
torch.Size([1, 885])
torch.Size([1, 885])
torch.Size([1, 885])
torch.Size([1, 885])
torch.Size([1, 885])
torch.Size([1, 885])
torch.Size([1, 885])
The indices are: tensor([   1,    4,    5,  ..., 2217, 2218, 2219], device='cuda:3')
The indices are: tensor([   1,    4,    5,  ..., 2217, 2218, 2219], device='cuda:3')
The indices are: tensor([   1,    4,    5,    7,    8,    9,   11,   12,   13,   14,   15,   16,
          17,   18,   19,   23,   24,   25,   31,   33,   36,   39,   40,   41,
          46,   47,   49,   51,   52,   54,   56,   59,   60,   61,   62,   63,
          64,   65,   66,   71,   74,   75,   77,   82,   91,   95,   96,   99,
         102,  103,  104,  105,  106,  107,  108,  109,  115,  117,  124,  126,
         127,  130,  136,  137,  144,  145,  154,  162,  170,  197,  199,  200,
         201,  207,  212,  216,  218,  219,  220,  223,  224,  228,  230,  237,
         238,  239,  240,  247,  251,  252,  253,  259,  285,  327,  334,  335,
         336,  337,  339,  341,  343,  344,  346,  347,  351,  358,  364,  370,
         372,  375,  380,  387,  390,  391,  394,  401,  419,  423,  435,  445,
         452,  462,  470,  486,  503,  507,  511,  514,  515,  516,  517,  525,
         526,  527,  582,  584,  591,  592,  596,  599,  600,  602,  603,  604,
         606,  607,  649,  653,  656,  661,  670,  673,  679,  694,  697,  698,
         705,  706,  708,  716,  722,  723,  724,  740,  744,  747,  748,  759,
         761,  770,  771,  773,  776,  787,  792,  796,  797,  798,  803,  804,
         807,  812,  813,  824,  826,  830,  833,  834,  835,  836,  845,  854,
         862,  863,  869,  873,  881,  882,  885,  886,  887,  890,  904,  907,
         909,  917,  921,  935,  938,  940,  945,  952,  959,  966,  970,  972,
         977,  984,  991,  998, 1002, 1004, 1016, 1023, 1030, 1034, 1036, 1048,
        1055, 1062, 1064, 1066, 1068, 1080, 1094, 1096, 1098, 1100, 1126, 1128,
        1130, 1132, 1137, 1158, 1162, 1164, 1176, 1183, 1190, 1192, 1194, 1196,
        1201, 1213, 1216, 1221, 1230, 1236, 1245, 1248, 1255, 1268, 1271, 1272,
        1273, 1274, 1275, 1278, 1294, 1299, 1311, 1312, 1313, 1314, 1318, 1319,
        1326, 1328, 1330, 1331, 1333, 1334, 1336, 1338, 1339, 1341, 1348, 1349,
        1350, 1351, 1353, 1354, 1355, 1356, 1357, 1361, 1362, 1363, 1364, 1365,
        1366, 1367, 1368, 1369, 1370, 1371, 1372, 1373, 1374, 1377, 1379, 1380,
        1385, 1386, 1393, 1401, 1409, 1410, 1411, 1412, 1416, 1418, 1419, 1421,
        1422, 1423, 1424, 1425, 1426, 1431, 1434, 1435, 1438, 1439, 1441, 1447,
        1449, 1460, 1465, 1467, 1468, 1471, 1474, 1476, 1481, 1488, 1490, 1494,
        1496, 1497, 1506, 1508, 1510, 1513, 1514, 1535, 1556, 1557, 1574, 1575,
        1576, 1580, 1581, 1587, 1588, 1593, 1598, 1608, 1609, 1613, 1620, 1627,
        1628, 1638, 1642, 1644, 1645, 1653, 1657, 1658, 1669, 1676, 1682, 1683,
        1695, 1697, 1698, 1703, 1704, 1705, 1706, 1708, 1709, 1711, 1716, 1719,
        1720, 1722, 1725, 1732, 1737, 1739, 1744, 1745, 1754, 1756, 1764, 1765,
        1766, 1767, 1768, 1769, 1770, 1771, 1772, 1773, 1774, 1775, 1776, 1777,
        1778, 1779, 1780, 1781, 1782, 1783, 1784, 1785, 1786, 1787, 1788, 1789,
        1790, 1791, 1792, 1793, 1794, 1795, 1796, 1797, 1798, 1799, 1800, 1801,
        1802, 1803, 1804, 1805, 1806, 1807, 1808, 1809, 1810, 1811, 1812, 1813,
        1814, 1815, 1816, 1817, 1818, 1819, 1820, 1821, 1822, 1823, 1824, 1825,
        1826, 1827, 1828, 1829, 1830, 1831, 1832, 1833, 1834, 1835, 1836, 1837,
        1838, 1839, 1840, 1841, 1842, 1843, 1844, 1845, 1846, 1847, 1848, 1849,
        1850, 1851, 1852, 1853, 1854, 1855, 1856, 1857, 1858, 1859, 1860, 1861,
        1862, 1863, 1864, 1865, 1866, 1867, 1868, 1869, 1870, 1871, 1872, 1873,
        1874, 1875, 1876, 1877, 1878, 1879, 1880, 1881, 1882, 1883, 1884, 1885,
        1886, 1887, 1888, 1889, 1890, 1891, 1892, 1893, 1894, 1895, 1896, 1897,
        1898, 1899, 1900, 1901, 1902, 1903, 1904, 1905, 1906, 1907, 1908, 1909,
        1910, 1911, 1912, 1913, 1914, 1915, 1916, 1917, 1918, 1919, 1920, 1921,
        1922, 1923, 1924, 1925, 1926, 1927, 1928, 1929, 1930, 1931, 1932, 1933,
        1934, 1935, 1936, 1937, 1938, 1939, 1940, 1941, 1942, 1943, 1944, 1945,
        1946, 1947, 1948, 1949, 1950, 1951, 1952, 1953, 1954, 1955, 1956, 1957,
        1958, 1959, 1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969,
        1970, 1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, 1981,
        1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993,
        1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005,
        2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017,
        2018, 2019, 2020, 2021, 2022, 2023, 2024, 2025, 2026, 2027, 2028, 2029,
        2030, 2031, 2032, 2033, 2034, 2035, 2036, 2037, 2038, 2039, 2040, 2041,
        2042, 2043, 2044, 2045, 2046, 2047, 2048, 2049, 2050, 2051, 2052, 2053,
        2054, 2055, 2056, 2057, 2058, 2059, 2060, 2061, 2062, 2063, 2064, 2065,
        2066, 2067, 2068, 2069, 2070, 2071, 2072, 2073, 2074, 2075, 2076, 2077,
        2078, 2079, 2080, 2081, 2082, 2083, 2084, 2085, 2086, 2087, 2088, 2089,
        2090, 2091, 2092, 2093, 2094, 2095, 2096, 2097, 2098, 2099, 2100, 2101,
        2102, 2103, 2104, 2105, 2106, 2107, 2108, 2109, 2110, 2111, 2112, 2113,
        2114, 2115, 2116, 2117, 2118, 2119, 2120, 2121, 2122, 2123, 2124, 2125,
        2126, 2127, 2128, 2129, 2130, 2131, 2132, 2133, 2134, 2135, 2136, 2137,
        2138, 2139, 2140, 2141, 2142, 2143, 2144, 2145, 2146, 2147, 2148, 2149,
        2150, 2151, 2152, 2153, 2154, 2155, 2156, 2157, 2158, 2159, 2160, 2161,
        2162, 2163, 2164, 2165, 2166, 2167, 2168, 2169, 2170, 2171, 2172, 2173,
        2174, 2175, 2176, 2177, 2178, 2179, 2180, 2181, 2182, 2183, 2184, 2185,
        2186, 2187, 2188, 2189, 2190, 2191, 2192, 2193, 2194, 2195, 2196, 2197,
        2198, 2199, 2200, 2201, 2202, 2203, 2204, 2205, 2206, 2207, 2208, 2209,
        2210, 2211, 2212, 2213, 2214, 2215, 2216, 2217, 2218, 2219],
       device='cuda:3')
The indices are: tensor([   1,    4,    9,   19,   30,   33,   34,   35,   36,   38,   39,   40,
          41,   42,   43,   45,   47,   56,   58,   61,   64,   66,   72,   74,
          87,   91,   93,   98,   99,  109,  111,  112,  115,  116,  117,  119,
         121,  122,  125,  126,  132,  133,  134,  136,  137,  138,  139,  142,
         146,  148,  155,  170,  174,  176,  180,  181,  208,  233,  238,  247,
         252,  258,  262,  266,  278,  281,  301,  321,  322,  327,  332,  338,
         341,  361,  381,  398,  401,  402,  407,  412,  418,  421,  426,  431,
         438,  441,  444,  446,  458,  461,  466,  478,  481,  482,  484,  486,
         487,  491,  498,  502,  506,  514,  519,  522,  523,  526,  527,  529,
         532,  535,  536,  537,  542,  545,  547,  550,  552,  567,  572,  574,
         591,  593,  596,  598,  615,  617,  620,  622,  637,  642,  644,  661,
         666,  668,  685,  687,  690,  692,  707,  709,  712,  714,  731,  733,
         736,  738,  755,  760,  762,  777,  779,  782,  784,  801,  803,  806,
         808,  824,  825,  827,  830,  832,  847,  852,  854,  871,  873,  876,
         878,  890,  895,  897,  900,  902,  922,  924,  946,  948,  967,  970,
         972,  989,  992,  994, 1016, 1018, 1040, 1042, 1057, 1059, 1062, 1064,
        1081, 1083, 1086, 1088, 1105, 1110, 1112, 1127, 1132, 1134, 1151, 1153,
        1156, 1158, 1175, 1177, 1180, 1182, 1196, 1197, 1202, 1204, 1215, 1220,
        1221, 1226, 1228, 1245, 1247, 1250, 1252, 1267, 1269, 1272, 1275, 1290,
        1297, 1299, 1321, 1323, 1340, 1343, 1345, 1364, 1367, 1369, 1391, 1393,
        1413, 1415, 1434, 1437, 1439, 1458, 1461, 1463, 1478, 1483, 1485, 1502,
        1507, 1509, 1526, 1528, 1531, 1533, 1548, 1550, 1553, 1556, 1573, 1578,
        1580, 1591, 1597, 1602, 1604, 1619, 1621, 1624, 1627, 1644, 1646, 1649,
        1652, 1667, 1669, 1674, 1676, 1683, 1684, 1689, 1696, 1698, 1708, 1713,
        1717, 1720, 1722, 1732, 1739, 1741, 1744, 1746, 1759, 1766, 1768, 1778,
        1783, 1790, 1792, 1809, 1811, 1814, 1816, 1831, 1833, 1836, 1839, 1854,
        1856, 1861, 1863, 1873, 1878, 1880, 1885, 1887, 1902, 1904, 1907, 1910,
        1927, 1929, 1932, 1935, 1950, 1952, 1957, 1959, 1967, 1968, 1972, 1974,
        1979, 1982, 1999, 2001, 2004, 2007, 2024, 2026, 2029, 2032, 2039, 2043,
        2047, 2053, 2054, 2080, 2134, 2139, 2144, 2149, 2154, 2159, 2160, 2165,
        2171, 2178, 2180, 2193, 2197, 2199, 2204, 2205, 2215, 2219],
       device='cuda:3')
The selected-indices are: [[454, 1885, 1717], [2041, 2085, 2061], [792, 2040, 2140], [1856, 1676, 808]]
torch.Size([3, 2232])
torch.Size([3, 2232])
  File "/data/data/arrv/ThinkTuning_v1/train.py", line 861, in <module>
    fire.Fire(main)
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/fire/core.py", line 143, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/fire/core.py", line 477, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/fire/core.py", line 693, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/ThinkTuning_v1/train.py", line 843, in main
    results = train(
              ^^^^^^
  File "/data/data/arrv/ThinkTuning_v1/train.py", line 393, in train
    outputs = think_tuner_step(batch, model=model, tokenizer=tokenizer)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/ThinkTuning_v1/src/think_tuner.py", line 304, in think_tuner_step
    total_gate_loss, total_reinforce_loss, total_nll_thought, logy = start_thinking(batch["input_ids"], outputs.last_hidden_state, logits,  batch["labels"], unreduced_loss, model, tokenizer)
                                                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/ThinkTuning_v1/src/think_tuner.py", line 262, in start_thinking
    new_hidden_states = model.model(
                        ^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/transformers/models/llama/modeling_llama.py", line 1001, in forward
    layer_outputs = decoder_layer(
                    ^^^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/transformers/models/llama/modeling_llama.py", line 734, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
                                                          ^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/transformers/models/llama/modeling_llama.py", line 617, in forward
    query_states = self.q_proj(hidden_states)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/accelerate/hooks.py", line 170, in new_forward
    output = module._old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/test/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 117, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 106.00 MiB. GPU 1 has a total capacity of 93.12 GiB of which 9.12 MiB is free. Including non-PyTorch memory, this process has 93.10 GiB memory in use. Of the allocated memory 90.66 GiB is allocated by PyTorch, and 1.71 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
