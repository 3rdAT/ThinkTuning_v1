Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:06<00:00,  3.41s/it]
<class 'datasets.arrow_dataset.Dataset'>
--> Training Set Length = 9000
--> Validation Set Length = 1000
/data/data/arrv/env/tv/lib/python3.12/site-packages/torch/cuda/memory.py:343: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
  warnings.warn(
Training Epoch: 1:   0%|[34m                                                                                                                                                [0m| 0/4500 [00:00<?, ?it/s][0mTraceback (most recent call last):
> [0;32m/data/data/arrv/ThinkTuning_v1/src/think_tuner.py[0m(288)[0;36mstart_thinking[0;34m()[0m
[0;32m    287 [0;31m[0;34m[0m[0m
[0m[0;32m--> 288 [0;31m    [0;32mfor[0m [0mi[0m[0;34m,[0m [0mindices[0m [0;32min[0m [0menumerate[0m[0;34m([0m[0mselected_indices[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m    289 [0;31m        [0;32mfor[0m [0midx[0m [0;32min[0m [0mindices[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m
[[71, 93, 146, 92, 194, 74, 220, 199, 68, 67], [75, 98, 97, 72, 251, 349, 68, 133, 316, 69]]
'<s> ###Input:\nThere are some sheets of paper, yellow on the front and green on the back on the floor. Students flipped 16 papers that look yellow so that they look green. If there are 64 more green papers than yellow papers, what was the difference before flipping? \n###Output:'
"<s> ###Input:\nThere are some sheets of paper, yellow on the front and green on the back on the floor. Students flipped 16 papers that look yellow so that they look green. If there are 64 more green papers than yellow papers, what was the difference before flipping? \n###Output:\nLet's denote the number of yellow papers as Y and the number of green papers as G.\n\nAfter flipping 16 yellow papers, the number of yellow papers decreased by 16 and the number of green papers increased by 16. So, we have:\n\nY - 16 = G + 16\n\nWe are also told that after flipping, there are 64 more green papers than yellow papers. So we can write:\n\nG + 16 = (Y - 16) + 64\n\nNow, let's solve for Y and G.\n\nG + 16 = Y + 48\n\nSubtract 16 from both sides to get:\n\nG = Y + 32\n\nNow we know that after flipping, the difference between green and yellow papers is 64. So before flipping, the difference was:\n\nDifference before flipping = Difference after flipping - 2 * Number of flipped papers\nDifference before flipping = 64 - 2 * 16\nDifference before flipping = 64 - 32\nDifference before flipping = 32\n\nSo, the difference in the number of papers before flipping was 32.</s>"
'<s> ###Input:\nThere are some sheets of paper, yellow on the front and green on the back on the floor. Students flipped 16 papers that look yellow so that they look green. If there are 64 more green papers than yellow papers, what was the difference before flipping? \n###Output:\nLet'
"<s> ###Input:\nThere are some sheets of paper, yellow on the front and green on the back on the floor. Students flipped 16 papers that look yellow so that they look green. If there are 64 more green papers than yellow papers, what was the difference before flipping? \n###Output:\nLet's denote the number of yellow papers as Y and the number of green papers as G.\n"
[[71, 93, 146, 92, 194, 74, 220, 199, 68, 67], [75, 98, 97, 72, 251, 349, 68, 133, 316, 69]]
"<s> ###Input:\nThere are some sheets of paper, yellow on the front and green on the back on the floor. Students flipped 16 papers that look yellow so that they look green. If there are 64 more green papers than yellow papers, what was the difference before flipping? \n###Output:\nLet's denote the number of yellow papers as Y and the number of green papers as G.\n"
"<s> ###Input:\nThere are some sheets of paper, yellow on the front and green on the back on the floor. Students flipped 16 papers that look yellow so that they look green. If there are 64 more green papers than yellow papers, what was the difference before flipping? \n###Output:\nLet's denote the number of yellow papers as Y and the number of green papers as G.\n\n"
"<s> ###Input:\nThere are some sheets of paper, yellow on the front and green on the back on the floor. Students flipped 16 papers that look yellow so that they look green. If there are 64 more green papers than yellow papers, what was the difference before flipping? \n###Output:\nLet's denote the number of yellow papers as Y and the number of green papers as G.\n\nAfter"
[[71, 93, 146, 92, 194, 74, 220, 199, 68, 67], [75, 98, 97, 72, 251, 349, 68, 133, 316, 69]]
"<s> ###Input:\nThere are some sheets of paper, yellow on the front and green on the back on the floor. Students flipped 16 papers that look yellow so that they look green. If there are 64 more green papers than yellow papers, what was the difference before flipping? \n###Output:\nLet's denote the number of yellow papers as Y and the number of green papers as G.\n\nAfter flipping 16 yellow papers, the number of yellow papers decreased by 16 and the number of green papers increased by 16. So, we have:\n\nY - 16 = G + 16\n\nWe are also told that after flipping, there are 64 more green papers than yellow papers. So we can write:\n\nG + 16 = (Y - 16) + 64\n\nNow, let's"
"<s> ###Input:\nThere are some sheets of paper, yellow on the front and green on the back on the floor. Students flipped 16 papers that look yellow so that they look green. If there are 64 more green papers than yellow papers, what was the difference before flipping? \n###Output:\nLet's denote the number of yellow papers as Y and the number of green papers as G.\n\nAfter flipping 16 yellow papers, the number of yellow papers decreased by 16 and the number of green papers increased by 16. So, we have:\n\nY - 16 = G + 16\n\nWe are also told that after flipping, there are 64 more green papers than yellow papers. So we can write:\n\nG + 16 = (Y - 16) + 64\n\nNow, let'"
"<s> ###Input:\nThere are some sheets of paper, yellow on the front and green on the back on the floor. Students flipped 16 papers that look yellow so that they look green. If there are 64 more green papers than yellow papers, what was the difference before flipping? \n###Output:\nLet's denote the number of yellow papers as Y and the number of green papers as G."
  File "/data/data/arrv/ThinkTuning_v1/train.py", line 877, in <module>
    fire.Fire(main)
  File "/data/data/arrv/env/tv/lib/python3.12/site-packages/fire/core.py", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/tv/lib/python3.12/site-packages/fire/core.py", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/tv/lib/python3.12/site-packages/fire/core.py", line 684, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/ThinkTuning_v1/train.py", line 861, in main
    results = train(
              ^^^^^^
  File "/data/data/arrv/ThinkTuning_v1/train.py", line 399, in train
    outputs = think_tuner_step(batch, model=model, tokenizer=tokenizer, train_config=train_config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/ThinkTuning_v1/src/think_tuner.py", line 495, in think_tuner_step
    return total_gate_loss, total_reinforce_loss, total_nll_thought, logy
                                                                     ^^^^^
  File "/data/data/arrv/ThinkTuning_v1/src/think_tuner.py", line 288, in start_thinking
    selected_indices_perp = []
                      ^^^^^^^^^
  File "/data/data/arrv/env/tv/lib/python3.12/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/tv/lib/python3.12/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
                      ^^^^^^^^^^^^^
bdb.BdbQuit

If you suspect this is an IPython 8.28.0 bug, please report it at:
    https://github.com/ipython/ipython/issues
or send an email to the mailing list at ipython-dev@python.org

You can print a more detailed traceback right now with "%tb", or use "%debug"
to interactively debug it.

Extra-detailed tracebacks for bug-reporting purposes can be enabled via:
    %config Application.verbose_crash=True
