Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:05<00:00,  2.99s/it]
<class 'datasets.arrow_dataset.Dataset'>
--> Training Set Length = 900
--> Validation Set Length = 100
The gate was not present, so initializing it!
/data/data/arrv/env/tv/lib/python3.12/site-packages/torch/cuda/memory.py:343: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
  warnings.warn(
Training Epoch: 1:   0%|[34m                                                                                                     [0m| 0/225 [00:00<?, ?it/s][0m/data/data/arrv/ThinkTuning_v1/src/think_tuner.py:210: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
tensor([  0,   4,   5,  10,  12,  14,  16,  18,  19,  21,  46,  47,  50,  51,
         56,  65,  70,  87,  93, 103, 109, 110, 111, 127, 128, 136, 142, 156,
        211, 226, 242, 301], device='cuda:3')
tensor([  0,   4,   5,  10,  17,  18,  19,  23,  29,  34,  39,  47,  49,  65,
         66,  70,  85,  97, 116, 124, 134, 146, 149, 163, 176, 179, 211, 226,
        234, 239, 262, 271, 278, 286, 293, 301], device='cuda:3')
tensor([  0,   4,   5,   6,   7,   8,   9,  10,  12,  14,  22,  27,  28,  37,
         38,  39,  41,  53,  55,  60,  68,  69,  71,  81,  84,  85,  86,  91,
         92,  93,  99, 110, 111, 113, 119, 134, 135, 136, 138, 148, 173, 174,
        175, 188, 189, 191, 202, 203, 204, 211, 212, 214, 232, 243, 244, 246,
        251, 283, 284, 298, 301], device='cuda:3')
tensor([  0,   4,  11,  19,  26,  33,  35,  67,  70,  71,  85,  88, 108, 109,
        228, 229, 239, 284, 301], device='cuda:3')
  sampled_token = torch.tensor(topk_indices.indices[i].unsqueeze(0)).to(device=new_sequence.device)  # Add the sampled token
Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
/data/data/arrv/env/tv/lib/python3.12/site-packages/torch/autograd/graph.py:769: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at ../aten/src/ATen/cuda/CublasHandlePool.cpp:135.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Training Epoch: 1/1, step 0/225 completed (loss: 0.8811295628547668):   0%|[34mâ–                                       [0m| 1/225 [00:21<1:18:39, 21.07s/it][0m
tensor([  0,   1,   2,   4,  13,  14,  45,  47,  50,  55,  59,  60,  61,  62,
         63,  64,  72,  85,  88,  90,  92,  93,  94,  95,  96, 100, 116, 119,
        120, 123, 126, 129, 133, 136, 137, 139, 141, 142, 145, 146, 154, 155,
        162, 171, 175, 177, 180, 182, 187, 192, 193, 199, 205, 206, 214, 217,
        218, 219, 220, 221, 224, 225, 226, 227, 228, 229, 230, 233, 237, 238,
        239, 246, 252, 253, 255, 257, 261, 267, 268, 269, 271, 274, 275, 276,
        279, 286, 289, 290, 293, 294, 297, 301, 305, 306, 309, 311, 313, 315,
        320, 326, 327, 335, 336, 337], device='cuda:3')
tensor([  0,   1,   2,   4,   5,  13,  51,  57,  58,  59,  62,  64,  72,  85,
         86,  90,  92,  93, 102, 103, 107, 115, 132, 133, 137, 139, 140, 146,
        153, 154, 161, 162, 171, 175, 176, 180, 190, 200, 207, 208, 210, 218,
        219, 223, 227, 243, 244, 245, 251, 252, 257, 259, 266, 267, 268, 269,
        270, 271, 272, 273, 274, 275, 279, 282, 286, 289, 290, 291, 294, 300,
        301, 307, 311, 314, 317, 320, 321, 329, 335, 336, 337],
       device='cuda:3')
tensor([  0,   1,   2,   4,   7,   8,  21,  27,  31,  32,  34,  39,  41,  52,
         56,  57,  63,  69,  71,  73,  74,  75,  78,  79,  80,  89,  96,  98,
        102, 106, 107, 110, 114, 118, 120, 122, 123, 124, 126, 131, 133, 140,
        141, 144, 145, 150, 158, 159, 160, 164, 165, 169, 170, 173, 174, 175,
        176, 177, 178, 179, 180, 181, 183, 185, 186, 189, 190, 197, 198, 206,
        207, 208, 209, 210, 213, 214, 218, 220, 224, 225, 227, 230, 231, 233,
        235, 240, 246, 247, 248, 249, 255, 257, 261, 263, 265, 266, 267, 268,
        269, 270, 271, 272, 276, 278, 279, 280, 281, 282, 283, 284, 285, 286,
        287, 288, 292, 293, 295, 298, 299, 300, 302, 303, 304, 305, 311, 312,
        313, 314, 315, 316, 318, 319, 320, 321, 322, 324, 327, 329, 331, 333,
        336, 337], device='cuda:3')
tensor([  0,   1,   2,   4,  15,  17,  21,  25,  30,  34,  36,  43,  46,  48,
         51,  54,  55,  57,  58,  59,  60,  62,  64,  67,  72,  76,  79,  86,
         87,  90,  91,  93,  94,  95,  97,  98,  99, 102, 103, 107, 109, 110,
        111, 112, 114, 117, 119, 120, 122, 124, 125, 126, 127, 131, 132, 134,
        136, 138, 139, 142, 144, 146, 148, 149, 151, 152, 153, 155, 157, 161,
        162, 169, 171, 174, 181, 183, 184, 185, 186, 187, 188, 189, 193, 194,
        195, 196, 197, 198, 199, 203, 204, 207, 208, 209, 210, 211, 215, 216,
        218, 220, 221, 222, 223, 224, 225, 226, 240, 243, 244, 245, 248, 249,
        257, 261, 264, 265, 266, 267, 269, 270, 273, 274, 275, 276, 279, 280,
        281, 282, 284, 286, 287, 288, 289, 292, 294, 295, 297, 298, 299, 303,
        305, 308, 310, 311, 312, 313, 319, 320, 321, 325, 331, 332, 333, 335,
        336, 337], device='cuda:3')
tensor([ 0,  1,  2,  3,  4,  6,  7,  8,  9, 12, 13, 14, 15, 16, 17, 19, 22, 23,
        24, 25, 44, 48, 55, 56, 57, 58, 60, 62, 63, 64, 65, 66, 70, 92, 93, 94],
       device='cuda:3')
tensor([ 0,  1,  2,  3,  4, 10, 11, 16, 17, 18, 19, 21, 23, 24, 27, 31, 33, 34,
        35, 36, 37, 43, 60, 73, 74, 82, 83, 86, 93, 94], device='cuda:3')
tensor([ 0,  1,  2,  3,  4, 27, 36, 37, 38, 39, 41, 76, 93, 94],
       device='cuda:3')
tensor([ 0,  1,  2,  3,  4,  5,  6,  7,  8, 14, 18, 20, 24, 27, 28, 40, 41, 42,
        43, 45, 46, 47, 48, 64, 66, 73, 81, 82, 90, 94], device='cuda:3')
tensor([  1,   4,   5,  34,  49,  58,  59,  60,  62,  63,  72,  79,  80,  83,
         84, 130, 165, 167, 178, 194, 196, 214, 216, 221, 231, 236, 238, 240,
        244, 247, 255, 290, 295, 300, 310, 329, 343, 352, 356, 363, 428, 473,
        507, 514, 523, 524, 525, 526], device='cuda:3')
tensor([  1,   4,  13,  26,  34,  37,  42,  43,  44,  46,  47,  48,  84,  85,
         88, 104, 124, 125, 131, 133, 159, 164, 171, 195, 196, 197, 206, 210,
        219, 221, 232, 251, 264, 311, 312, 319, 320, 427, 524, 525, 526],
       device='cuda:3')
tensor([  1,   4,   5,  12,  13,  15,  16,  29,  39,  61,  63,  75,  81,  82,
         84,  94, 100, 102, 107, 115, 116, 117, 118, 119, 137, 141, 142, 144,
        157, 167, 211, 236, 247, 250, 252, 260, 267, 275, 288, 289, 292, 293,
        299, 320, 336, 348, 382, 390, 423, 442, 449, 483, 500, 501, 502, 509,
        524, 525, 526], device='cuda:3')
tensor([  1,   4,   8,  11,  12,  13,  23,  24,  25,  27,  28,  33,  39,  52,
         53,  56,  69,  71,  83,  86,  97,  98, 115, 120, 129, 147, 149, 157,
        172, 173, 186, 191, 223, 235, 243, 275, 350, 353, 392, 401, 426, 446,
        458, 501, 511, 526], device='cuda:3')
tensor([  1,   4,  24,  35,  38,  40,  47,  52,  54,  84,  86,  91,  93,  96,
         97, 118, 119, 123, 125, 129, 131, 135, 137, 147, 148, 152, 175, 176,
        177, 200, 201, 249, 251, 269, 287, 288, 289], device='cuda:3')
tensor([  1,   4,  12,  13,  14,  15,  17,  19,  29,  32,  33,  34,  42,  44,
         45,  46,  50,  51,  54,  57,  58,  59,  65,  68,  69,  70,  78,  79,
         81,  85,  86,  92,  93,  94,  95,  98, 104, 106, 107, 112, 116, 134,
        139, 140, 150, 154, 157, 158, 183, 184, 185, 186, 189, 190, 197, 198,
        227, 237, 268, 272, 281, 284, 285, 288, 289], device='cuda:3')
tensor([  1,   4,   6,   7,   8,  10,  12,  18,  21,  22,  25,  26,  33,  35,
         38,  71,  80,  84, 123, 147, 162, 166, 222, 226, 269, 288, 289],
       device='cuda:3')
tensor([  1,   4,   5,  21,  23,  27,  28,  41,  44,  45,  49,  53,  55,  56,
         57,  62,  65,  74,  76,  77,  80,  82,  92, 104, 106, 107, 108, 117,
        119, 122, 123, 127, 128, 133, 134, 137, 138, 139, 140, 142, 148, 165,
        166, 169, 171, 173, 175, 176, 180, 183, 184, 198, 202, 220, 231, 243,
        247, 248, 249, 257, 262, 289], device='cuda:3')
tensor([  1,   4,  10,  23,  25,  41,  42,  45,  57,  58,  66,  72,  73,  75,
         95,  97, 107, 116, 120, 121, 137, 149, 152, 183, 185, 191, 192, 211,
        239, 247, 248, 262, 273, 291, 300, 307, 308, 322, 323, 324],
       device='cuda:3')
tensor([  1,   4,   5,   6,   7,   8,  11,  13,  24,  25,  37,  49,  52,  61,
         62,  65,  68,  79,  82, 101, 102, 105, 109, 124, 126, 127, 129, 135,
        136, 175, 189, 206, 214, 215, 224, 237, 240, 245, 260, 275, 288, 293,
        299, 300, 301, 319, 322, 323, 324], device='cuda:3')
tensor([  1,   4,   9,  10,  12,  13,  14,  15,  16,  20,  21,  22,  23,  27,
         28,  30,  31,  32,  33,  34,  36,  37,  40,  41,  42,  46,  47,  49,
         50,  55,  56,  61,  63,  64,  65,  68,  69,  70,  71,  72,  74,  79,
         80,  83,  85,  87,  91,  93,  94,  96,  97, 100, 103, 104, 111, 112,
        115, 116, 117, 118, 122, 124, 126, 127, 128, 129, 130, 133, 136, 144,
        145, 146, 150, 151, 158, 165, 173, 177, 194, 195, 227, 228, 234, 248,
        250, 262, 271, 272, 276, 279, 319, 320, 323, 324], device='cuda:3')
tensor([  1,   4,   7,   8,   9,  11,  17,  18,  20,  21,  22,  26,  27,  31,
         32,  34,  35,  36,  37,  38,  44,  45,  48,  54,  57,  58,  59,  60,
         61,  65,  75,  83,  84,  93,  96, 101, 103, 107, 108, 110, 111, 113,
        114, 117, 118, 124, 126, 127, 128, 131, 132, 134, 135, 146, 152, 154,
        159, 160, 166, 168, 178, 180, 201, 205, 208, 209, 227, 231, 275, 290,
        312, 324], device='cuda:3')
tensor([  1,  16,  21,  27,  28,  29,  32,  37,  40,  46,  47,  66,  71,  72,
         86,  96, 104, 122, 123, 124, 132], device='cuda:3')
tensor([  1,   5,   6,   7,  11,  12,  13,  14,  16,  19,  20,  23,  28,  32,
         41,  44,  45,  46,  47,  54,  58,  64,  68,  77,  80,  93,  95, 104,
        118, 122, 127, 132], device='cuda:3')
tensor([  1,   6,   9,  10,  11,  13,  14,  20,  21,  24,  25,  26,  27,  28,
         32,  33,  36,  37,  38,  41,  42,  44,  47,  48,  50,  57,  60,  61,
         64,  65,  67,  68,  69,  73,  75,  76,  79,  81,  82,  84,  88,  89,
         98, 103, 104, 105, 106, 107, 108, 109, 110, 111, 113, 116, 121, 127,
        128, 129, 132], device='cuda:3')
tensor([  1,  10,  16,  17,  26,  29,  35,  38,  39,  45,  48,  58,  59,  61,
         62,  65,  66,  67,  81,  85,  86,  87,  92,  93,  96,  99, 124, 132],
       device='cuda:3')
tensor([  1,  22,  25,  27,  33,  48,  56,  59,  61,  64,  65,  66,  68,  69,
         70,  73,  74,  80,  81,  83,  96, 111, 113, 121, 134, 153, 161, 187,
        190, 191, 197, 198, 205, 207, 210, 211, 212, 221, 223, 225, 226, 227,
        237, 238, 252, 260], device='cuda:3')
tensor([  1,   7,  15,  19,  21,  28,  32,  38,  41,  46,  48,  50,  65,  69,
         71,  77,  78,  79,  85,  97,  98, 101, 104, 113, 115, 117, 124, 130,
        143, 144, 145, 146, 147, 149, 151, 167, 172, 175, 178, 179, 180, 187,
        188, 189, 190, 200, 201, 206, 211, 236, 238, 242, 245, 256, 257, 260],
       device='cuda:3')
tensor([  1,   5,   6,  10,  11,  12,  17,  18,  19,  20,  21,  22,  25,  27,
         28,  29,  30,  31,  35,  41,  43,  44,  50,  53,  55,  67,  70,  72,
         73,  76,  77,  78,  80,  81,  83,  84,  86,  87,  90,  92,  98,  99,
        102, 108, 115, 117, 118, 121, 124, 125, 128, 129, 130, 133, 134, 136,
        138, 139, 140, 141, 142, 145, 146, 151, 152, 153, 154, 155, 166, 169,
        170, 178, 184, 189, 194, 195, 202, 221, 228, 230, 234, 247, 252, 254,
        256, 257, 260], device='cuda:3')
tensor([  1,   9,  10,  16,  22,  25,  32,  44,  45,  46,  48,  51,  66,  67,
         70,  74,  75,  77,  78,  79,  80,  81,  82,  83,  84,  88,  89,  95,
         99, 100, 104, 106, 107, 110, 124, 125, 127, 128, 129, 130, 137, 138,
        142, 144, 147, 148, 174, 177, 178, 179, 182, 184, 185, 186, 187, 189,
        190, 193, 194, 195, 196, 197, 199, 200, 204, 207, 208, 218, 219, 228,
        238, 239, 251, 260], device='cuda:3')
tensor([  1,  10,  11,  13,  14,  15,  16,  17,  18,  21,  23,  25,  26,  27,
         28,  29,  37,  40,  59,  63,  71,  73,  74,  81,  82,  86,  96, 102,
        103, 107, 110, 111, 115, 116, 118, 119, 120, 121, 122, 130, 131, 132,
        161, 163, 165, 170, 173, 174, 175, 176, 181, 182, 184, 193, 222, 225,
        236, 242], device='cuda:3')
tensor([  1,  11,  12,  13,  14,  15,  16,  17,  19,  22,  23,  25,  26,  27,
         28,  29,  30,  32,  33,  34,  36,  37,  38,  40,  42,  43,  44,  45,
         51,  57,  58,  59,  61,  62,  63,  67,  68,  72,  76,  82,  83,  84,
         87, 125, 137, 144, 151, 152, 158, 162, 163, 164, 170, 173, 182, 187,
        189, 190, 193, 194, 197, 198, 207, 209, 223, 225, 228, 230, 232, 233,
        242], device='cuda:3')
tensor([  1,   7,  11,  12,  13,  14,  15,  16,  17,  18,  19,  21,  22,  23,
         26,  29,  30,  31,  34,  38,  44,  47,  50,  54,  55,  61,  62,  63,
         64,  65,  66,  71,  72,  75,  76,  78,  86,  89,  90,  93,  96,  99,
        100, 101, 102, 105, 108, 109, 110, 116, 118, 127, 128, 131, 136, 138,
        139, 147, 150, 159, 162, 164, 165, 174, 177, 179, 180, 181, 182, 184,
        185, 191, 195, 197, 198, 199, 200, 206, 208, 209, 211, 212, 222, 232,
        239, 242], device='cuda:3')
tensor([  1,   9,  10,  20,  21,  22,  30,  32,  37,  40,  42,  43,  45,  47,
         55,  65,  66,  69,  70,  71,  80,  81,  82,  86,  87,  89,  94, 106,
        108, 123, 128, 130, 138, 160, 173, 186, 187, 189, 197, 201, 203, 224,
        235, 237, 242], device='cuda:3')
tensor([  1,  13,  18,  19,  21,  22,  33,  34,  36,  37,  54,  58,  59,  63,
         66,  68,  69,  76,  77, 101, 102, 112, 113, 127, 130, 140, 147, 150,
        155, 157, 158, 159, 164, 168, 181, 189, 191, 195, 202, 206, 236, 247,
        248, 253, 261, 263, 265, 269, 273, 274, 282, 284, 289, 296, 299, 313,
        319, 320, 332, 338, 351, 352, 355, 356, 358, 371, 375, 378, 398, 399,
        400, 410, 411, 423, 433, 434, 449, 450, 451, 452, 453],
       device='cuda:3')
tensor([  1,   5,   6,   7,   9,  10,  11,  13,  16,  17,  25,  40,  41,  42,
         50,  51,  52,  53,  81,  82,  84,  87,  88,  89,  91,  97, 104, 108,
        109, 124, 125, 130, 131, 132, 145, 146, 147, 150, 151, 152, 153, 154,
        163, 173, 180, 181, 187, 200, 205, 207, 208, 232, 236, 237, 238, 244,
        251, 255, 256, 257, 267, 273, 275, 276, 278, 281, 282, 283, 291, 303,
        309, 310, 314, 315, 316, 328, 342, 347, 353, 357, 360, 371, 379, 381,
        383, 384, 389, 391, 397, 403, 404, 407, 409, 413, 429, 430, 432, 435,
        436, 437, 450, 451, 452, 453], device='cuda:3')
tensor([  1,  12,  13,  14,  17,  20,  21,  24,  25,  26,  30,  31,  37,  47,
         48,  49,  50,  58,  67,  71,  72,  75,  77,  82,  84,  85,  86,  88,
         89,  90,  92,  97,  98, 100, 106, 109, 112, 116, 118, 145, 146, 154,
        156, 166, 169, 177, 178, 183, 188, 198, 216, 217, 223, 247, 255, 256,
        262, 269, 272, 273, 275, 277, 278, 282, 294, 326, 327, 328, 338, 344,
        345, 350, 355, 356, 357, 361, 371, 372, 377, 384, 395, 396, 416, 425,
        426, 428, 433, 447, 450, 451, 452, 453], device='cuda:3')
tensor([  1,   9,  16,  17,  37,  45,  58,  64,  71,  72,  73,  75,  82,  84,
         89,  97,  98, 123, 128, 130, 131, 133, 134, 143, 147, 165, 171, 172,
        175, 180, 198, 208, 215, 226, 236, 243, 251, 253, 254, 255, 256, 264,
        268, 270, 271, 284, 288, 290, 291, 311, 327, 330, 333, 335, 339, 342,
        343, 360, 362, 366, 367, 372, 376, 408, 410, 414, 421, 422, 431, 436,
        453], device='cuda:3')
tensor([  1,   6,   8,  11,  12,  13,  14,  15,  17,  18,  24,  25,  26,  28,
         29,  30,  36,  37,  38,  40,  41,  44,  45,  47,  48,  52,  53,  55,
         66,  69,  72,  76,  77,  86,  89,  90,  91,  93,  94,  95,  96,  97,
         98, 101, 102, 105, 107, 110, 111, 112, 113, 116, 118, 119, 120, 127,
        132, 135, 136, 137, 143, 144, 145, 150, 154, 155, 156, 161, 162, 164,
        165, 168, 170, 171, 172, 178, 180, 181, 188, 198, 199, 200, 203, 204,
        205, 206], device='cuda:3')
tensor([  1,   5,   7,  10,  12,  13,  14,  15,  18,  19,  21,  22,  23,  25,
         28,  29,  31,  32,  35,  36,  39,  40,  42,  53,  54,  55,  57,  58,
         59,  64,  74,  77,  80,  90,  98,  99, 101, 104, 108, 109, 116, 118,
        125, 126, 130, 131, 132, 133, 138, 144, 145, 148, 149, 150, 158, 159,
        161, 162, 163, 164, 165, 166, 168, 169, 170, 171, 174, 175, 177, 178,
        179, 181, 195, 197, 198, 200, 201, 202, 204, 205, 206],
       device='cuda:3')
tensor([  1,   5,   6,   8,   9,  12,  14,  15,  17,  18,  19,  20,  21,  22,
         23,  24,  25,  26,  27,  31,  35,  51,  52,  53,  55,  57,  62,  70,
         72,  80,  81,  82,  83, 101, 102, 103, 105, 110, 131, 140, 155, 166,
        168, 172, 179, 181, 182, 184, 185, 200, 201, 205, 206],
       device='cuda:3')
tensor([  1,  10,  14,  17,  19,  22,  24,  26,  31,  35,  37,  39,  41,  42,
         44,  47,  49,  53,  56,  61,  70,  71,  72,  73,  74,  76,  77,  78,
         80,  81,  82,  90,  91, 101, 104, 107, 111, 112, 113, 114, 115, 121,
        125, 127, 136, 141, 142, 143, 145, 146, 148, 149, 153, 165, 183, 188,
        196, 198, 206], device='cuda:3')
tensor([  5,   6,  10,  12,  13,  28,  39,  45,  52,  73,  75,  84,  94,  97,
        104, 121, 125, 126, 132, 138, 151, 162, 164, 166, 193, 207, 209, 210,
        211, 213, 229, 230, 238, 239], device='cuda:3')
tensor([  5,   6,   8,   9,  10,  13,  14,  15,  17,  20,  22,  28,  29,  31,
         32,  42,  45,  53,  64,  74,  75,  77,  78,  82,  83,  84,  85,  86,
         87,  88,  91,  95, 100, 102, 113, 132, 134, 136, 143, 145, 151, 156,
        158, 162, 163, 164, 165, 167, 171, 174, 179, 180, 183, 185, 190, 194,
        198, 201, 204, 207, 211, 213, 220, 223, 226, 238, 239],
       device='cuda:3')
tensor([  5,  11,  12,  13,  14,  16,  17,  18,  19,  20,  21,  22,  23,  24,
         30,  33,  35,  40,  42,  43,  48,  49,  53,  58,  61,  65,  67,  68,
         70,  72,  73,  75,  89,  92,  96, 101, 102, 103, 104, 106, 113, 115,
        132, 135, 137, 144, 148, 151, 154, 155, 158, 167, 181, 182, 196, 205,
        210, 211, 212, 218, 231, 232, 234, 239], device='cuda:3')
tensor([  9,  10,  13,  14,  15,  18,  20,  28,  29,  35,  44,  45,  46,  49,
         57,  61,  66,  69,  70,  77,  87,  88,  89,  95, 102, 120, 147, 154,
        162, 166, 169, 170, 172, 179, 189, 196, 197, 203, 206, 221, 239],
       device='cuda:3')
tensor([  5,   6,  11,  13,  20,  26,  43,  44,  53,  54,  63,  65, 127, 128,
        129], device='cuda:3')
tensor([  5,   7,   8,   9,  10,  12,  14,  16,  19,  24,  26,  29,  30,  31,
         45,  49,  50,  51,  52,  55,  56,  57,  58,  61,  68,  69,  82,  85,
         86,  88,  89,  90,  95, 103, 114, 116, 117, 122, 124, 128, 129],
       device='cuda:3')
tensor([  7,   9,  10,  11,  12,  13,  16,  17,  18,  19,  20,  26,  27,  28,
         29,  34,  35,  36,  39,  50,  51,  55,  56,  62,  66,  67,  70,  71,
         74,  75,  76,  77,  83,  84,  85,  89, 100, 101, 104, 108, 110, 121,
        124, 125, 128, 129], device='cuda:3')
tensor([  9,  13,  16,  22,  23,  27,  28,  29,  30,  36,  44,  49,  53,  55,
         56,  58,  64,  65,  66,  70,  74,  76,  78,  85,  91,  98, 105, 116,
        118, 121, 129], device='cuda:3')
tensor([  6,   8,   9,  10,  13,  14,  17,  18,  19,  20,  22,  23,  24,  26,
         27,  30,  33,  41,  42,  43,  58,  59,  91, 101, 103, 104, 118, 120,
        125, 127, 130, 131, 142, 143, 158, 159, 173, 174, 180, 181, 188, 196,
        206, 207, 208, 210, 211, 218, 219], device='cuda:3')
tensor([  5,   6,   7,   8,  15,  18,  21,  28,  30,  35,  36,  42,  44,  54,
         66,  67,  73,  78,  79,  80,  81,  92, 105, 110, 114, 125, 131, 134,
        142, 147, 150, 157, 174, 181, 186, 188, 195, 206, 211, 214, 218, 219],
       device='cuda:3')
tensor([  7,  15,  26,  35,  45,  51,  55,  56,  63,  64,  68,  69,  74,  89,
        111, 219], device='cuda:3')
tensor([  5,   6,   7,   8,  11,  17,  21,  22,  23,  31,  32,  33,  48,  50,
         51,  53,  61,  67,  68,  69,  70,  83,  85,  92,  93, 110, 113, 114,
        115, 116, 125, 126, 146, 148, 149, 150, 151, 152, 159, 160, 168, 176,
        177, 179, 187, 198, 201, 207, 208, 210, 219], device='cuda:3')
tensor([  8,  10,  11,  13,  14,  22,  23,  24,  26,  27,  29,  30,  31,  32,
         35,  37,  41,  42,  43,  44,  50,  51,  52,  54,  55,  59,  60,  62,
         66,  67,  68,  87,  96,  99, 100, 102, 111, 118, 127, 128, 129, 137,
        138, 145, 147, 148, 154, 156, 167, 168, 169, 181, 182, 186, 187, 195,
        205, 210, 211, 222, 238, 240, 251, 253, 254, 255, 256, 282, 283, 286,
        287], device='cuda:3')
tensor([  5,   8,  12,  14,  26,  28,  30,  33,  47,  48,  49,  55,  56,  57,
         61,  62,  67,  70,  75,  80,  87,  89,  91,  92,  94,  95,  96, 102,
        111, 112, 128, 138, 140, 141, 152, 154, 174, 188, 193, 226, 238, 252,
        253, 268, 275, 277, 280, 283, 284, 287], device='cuda:3')
tensor([  6,   7,   8,   9,  10,  11,  12,  18,  20,  21,  23,  24,  25,  26,
         27,  34,  36,  37,  39,  46,  61,  62,  66,  69,  79,  83,  90,  94,
         99, 104, 107, 109, 115, 119, 122, 124, 127, 132, 139, 140, 142, 149,
        150, 152, 163, 165, 166, 167, 169, 189, 190, 191, 192, 193, 204, 221,
        232, 233, 242, 243, 250, 254, 282, 283, 284, 287], device='cuda:3')
tensor([  7,   8,   9,  10,  11,  12,  14,  15,  16,  25,  26,  27,  28,  29,
         41,  42,  57,  62,  69,  70,  80,  84,  90,  91,  93, 112, 119, 124,
        128, 129, 144, 146, 153, 156, 157, 158, 159, 160, 163, 172, 181, 182,
        183, 184, 185, 188, 255, 256, 260, 262, 263, 267, 287],
       device='cuda:3')
tensor([  7,   9,  11,  12,  13,  23,  36,  47,  54,  56,  78,  79,  81,  82,
         86,  87,  88,  89,  90,  92,  93,  94, 104, 108, 114, 121, 123, 126,
        127, 128, 133, 137, 139, 141, 148, 154, 155, 156, 157, 176, 190, 210,
        211, 212], device='cuda:3')
tensor([  9,  12,  15,  17,  20,  30,  33,  40,  42,  43,  44,  51,  62,  64,
         65,  66,  80,  85,  86,  90, 108, 110, 123, 145, 167, 176, 192, 204,
        211, 212], device='cuda:3')
tensor([  5,   7,   8,  10,  13,  19,  21,  22,  23,  27,  28,  35,  36,  53,
         56,  60,  65,  69,  70,  81,  83,  84,  93,  94,  95,  96,  97,  98,
        107, 116, 119, 120, 121, 122, 123, 124, 126, 129, 131, 132, 146, 150,
        158, 165, 180, 181, 186, 194, 199, 207, 208, 211, 212],
       device='cuda:3')
tensor([  5,   8,   9,  12,  14,  41,  42,  57,  58,  59,  60,  72,  75, 105,
        112, 117, 118, 122, 124, 125, 133, 137, 139, 140, 150, 161, 169, 170,
        178, 190, 195, 197, 199, 212], device='cuda:3')
tensor([  6,   7,   8,  10,  12,  19,  20,  23,  30,  34,  41,  58,  62,  65,
         83,  86, 102, 133, 144, 162, 186, 197, 209, 228, 241, 245, 261, 276,
        278, 288, 291, 305], device='cuda:3')
tensor([  6,   7,   8,   9,  15,  17,  29,  34,  43,  89, 138, 141, 179, 180,
        254, 258, 276, 278, 294, 305], device='cuda:3')
tensor([  9,  37,  44,  57,  58,  67,  74,  75,  89,  95,  98, 100, 102, 134,
        135, 136, 151, 168, 179, 185, 190, 194, 195, 202, 243, 249, 263, 271,
        287, 297, 305], device='cuda:3')
tensor([  8,  21,  22,  25,  29,  30,  32,  33,  34,  35,  36,  50,  51,  52,
         62,  63,  65,  67,  70,  73,  78,  87, 104, 116, 133, 143, 154, 167,
        171, 173, 175, 198, 206, 223, 239, 249, 250, 259, 267, 279, 283, 289,
        305], device='cuda:3')
tensor([  5,   8,   9,  12,  14,  15,  17,  18,  22,  23,  53,  54,  55,  56,
         65,  68,  71,  72,  75,  78,  80,  91,  92,  94,  96,  97, 102, 103,
        105, 107, 108, 109, 113, 115, 118, 119, 121, 130, 131, 135, 136, 142,
        143, 177, 179, 190, 195, 203, 211, 222, 223, 224, 236, 244, 245, 251,
        254, 263, 265, 266, 276, 287, 296, 297, 305, 306, 307, 320, 321, 322,
        323, 324, 326, 331, 334, 337, 352, 353], device='cuda:3')
tensor([  8,   9,  10,  12,  13,  14,  15,  20,  23,  26,  27,  30,  31,  33,
         35,  40,  41,  43,  45,  58,  62,  69,  76,  82,  83,  88,  90,  92,
         94,  96,  97,  99, 100, 103, 113, 114, 115, 116, 118, 128, 139, 153,
        160, 185, 186, 190, 196, 212, 219, 222, 227, 240, 242, 261, 262, 263,
        265, 270, 285, 287, 289, 290, 291, 293, 294, 295, 298, 305, 306, 307,
        314, 316, 328, 336, 339, 342], device='cuda:3')
tensor([  5,  11,  20,  21,  23,  25,  29,  34,  35,  37,  39,  49,  67,  79,
         83,  88,  92, 100, 101, 116, 129, 133, 139, 140, 145, 146, 152, 194,
        195, 202, 219, 220, 222, 225, 229, 258, 264, 265, 274, 278, 300, 333,
        342, 353], device='cuda:3')
tensor([  5,   6,   8,  10,  40,  43,  45,  47,  58,  61,  63,  64,  79, 102,
        103, 104, 116, 117, 123, 127, 168, 169, 172, 191, 215, 218, 234, 251,
        252, 263, 270, 275, 276, 279, 281, 282, 290, 295, 297, 298, 304, 316,
        319, 332, 353], device='cuda:3')
tensor([  6,   7,   8,   9,  10,  19,  20,  22,  23,  24,  25,  32,  34,  41,
         43,  49,  50,  52,  56,  57,  58,  61,  63,  64,  65,  67,  69,  81,
         83,  86,  89,  92,  94,  95,  96, 100, 104, 105, 106, 107, 113, 114,
        120, 127, 133, 137, 144, 158, 175, 180, 181, 182, 183, 184, 185, 187,
        196, 206, 215, 219, 228, 231, 235, 236, 237, 238, 240, 245, 254, 262,
        264, 266, 274, 278, 280, 282, 284, 291, 292, 293, 295, 315, 316, 317,
        321, 322, 331, 357, 361, 364, 370, 371, 372, 374, 388, 389],
       device='cuda:3')
tensor([  6,   7,   8,   9,  10,  11,  12,  13,  17,  18,  20,  22,  24,  28,
         31,  32,  33,  34,  35,  37,  38,  39,  40,  42,  43,  44,  48,  49,
         50,  51,  52,  54,  56,  57,  59,  66,  69,  84,  89,  90,  91,  93,
         97,  98, 102, 115, 116, 117, 118, 123, 132, 133, 134, 135, 139, 146,
        153, 168, 176, 177, 181, 182, 183, 184, 188, 190, 212, 216, 217, 218,
        219, 221, 226, 238, 246, 250, 255, 256, 260, 262, 263, 269, 273, 274,
        276, 295, 308, 322, 373, 376, 384, 385, 388, 389], device='cuda:3')
tensor([  8,   9,  10,  11,  12,  13,  20,  21,  22,  28,  32,  36,  37,  38,
         41,  46,  47,  50,  53,  57,  61,  62,  64,  66,  67,  68,  83,  84,
         85,  95,  97, 100, 113, 114, 115, 120, 121, 124, 127, 137, 145, 148,
        149, 160, 161, 163, 164, 166, 182, 188, 189, 190, 198, 209, 210, 214,
        216, 221, 238, 268, 274, 276, 284, 301, 302, 307, 319, 320, 323, 325,
        368, 369, 370, 371, 380, 381, 382, 385, 388, 389], device='cuda:3')
tensor([  5,   6,   7,   8,   9,  14,  15,  16,  23,  24,  26,  33,  34,  35,
         36,  43,  44,  46,  53,  54,  56,  64,  65,  67,  71,  73,  75,  87,
         88,  90, 101, 102, 104, 122, 179, 181, 182, 185, 193, 215, 219, 220,
        255, 269, 310, 317, 326, 334, 340, 346, 369, 385, 386, 389],
       device='cuda:3')
tensor([  9,  11,  13,  14,  15,  19,  23,  25,  26,  27,  29,  33,  35,  37,
         38,  40,  56,  58,  59,  60,  61,  62,  63,  85,  97,  98, 100, 101,
        104, 130, 131, 132, 134, 136, 144, 147, 176, 196, 201, 207, 219, 231,
        238, 240, 241, 244, 245], device='cuda:3')
tensor([ 10,  11,  22,  27,  28,  32,  38,  43,  54,  74,  89, 102, 121, 165,
        186, 193, 194, 210, 214, 225, 241], device='cuda:3')
tensor([ 27,  28,  29,  31,  32,  33,  37,  39,  40,  41,  60,  63,  69,  70,
         71,  73,  75,  93,  94,  95,  98,  99, 100, 102, 106, 108, 109, 110,
        127, 130, 131, 134, 135, 138, 139, 140, 141, 143, 144, 148, 155, 156,
        157, 158, 201, 202, 203, 204, 205, 214, 215, 216, 218, 220, 223, 244,
        245], device='cuda:3')
tensor([  6,   8,   9,  13,  21,  22,  25,  45,  88,  89, 175, 245],
       device='cuda:3')
tensor([ 10,  11,  12,  13,  14,  16,  17,  23,  24,  26,  27,  30,  36,  43,
         45,  50,  51,  52,  68,  69,  84,  85,  86,  92,  94, 100, 102, 114,
        139, 151, 164, 174, 179, 180, 185, 186, 191, 199, 203, 205],
       device='cuda:3')
tensor([ 17,  18,  20,  27,  28,  33,  34,  36,  39,  43,  49,  67,  82,  91,
        102, 103, 115, 123, 124, 127, 160, 178, 183, 185, 186, 187, 200, 201,
        204, 206, 209, 210, 212, 215, 216], device='cuda:3')
tensor([  9,  29,  30,  31,  37,  53,  54,  59,  73,  74,  75,  76,  85,  87,
         90,  91, 100, 101, 106, 122, 154, 164, 165, 175, 176, 185, 196, 197,
        199, 215, 216], device='cuda:3')
tensor([  7,  11,  18,  21,  25,  28,  30,  38,  43,  57,  60,  61,  66,  68,
         72,  79,  80,  81,  82,  84,  88, 103, 105, 120, 125, 130, 132, 134,
        135, 136, 137, 141, 142, 147, 148, 152, 157, 161, 162, 163, 164, 167,
        168, 171, 172, 198, 216], device='cuda:3')
tensor([  5,   6,   7,   9,  10,  11,  13,  14,  16,  19,  20,  24,  25,  26,
         27,  32,  33,  35,  37,  38,  39,  40,  42,  43,  44,  45,  46,  47,
         48,  49,  54,  55,  57,  62,  63,  68,  69,  71,  74,  75,  77,  78,
         92,  99, 102, 103, 109, 117, 118, 122, 123, 132, 133, 134, 135, 147,
        148, 153, 154, 160, 161, 167, 168, 192, 195, 196, 198, 205, 208, 222,
        223, 225, 232, 233, 237, 238, 298, 345, 347, 430, 431, 433, 446, 451,
        460, 495, 497, 501, 507, 508, 510], device='cuda:3')
tensor([  5,   8,   9,  11,  12,  18,  24,  31,  48,  53,  72,  73,  74,  75,
         77,  87,  90,  94, 103, 106, 129, 170, 178, 186, 192, 200, 205, 245,
        258, 260, 273, 276, 286, 297, 299, 315, 324, 325, 326, 331, 337, 338,
        347, 348, 354, 374, 375, 376, 389, 390, 394, 395, 397, 398, 401, 408,
        409, 410, 411, 412, 421, 422, 423, 424, 431, 432, 433, 434, 459, 460,
        461, 462, 476, 479, 487, 489, 491, 516, 517, 518, 519, 520, 521, 522,
        523], device='cuda:3')
tensor([  5,  10,  11,  12,  16,  17,  18,  19,  21,  22,  23,  24,  25,  26,
         27,  28,  29,  30,  35,  37,  39,  40,  45,  46,  48,  49,  50,  51,
         57,  60,  62,  65,  66,  67,  73,  80,  93,  95, 102, 105, 107, 110,
        119, 123, 141, 142, 146, 149, 169, 178, 184, 185, 190, 192, 193, 194,
        207, 208, 218, 221, 227, 234, 242, 247, 251, 252, 263, 266, 269, 272,
        276, 277, 278, 285, 286, 287, 292, 293, 297, 300, 306, 307, 315, 322,
        333, 336, 342, 343, 366, 381, 382, 383, 386, 393, 403, 404, 410, 418,
        425, 426, 433, 435, 442, 449, 454, 466, 481, 498, 499, 503, 504, 505,
        511], device='cuda:3')
tensor([  5,   6,   7,   8,  11,  12,  17,  18,  21,  22,  24,  25,  29,  30,
         34,  35,  36,  40,  46,  47,  49,  58,  59,  61,  71,  72,  74,  77,
         86,  87,  89, 119, 122, 125, 126, 148, 153, 155, 156, 157, 164, 165,
        171, 176, 177, 178, 182, 183, 185, 191, 192, 201, 202, 210, 212, 217,
        225, 226, 231, 232, 235, 240, 244, 245, 250, 267, 268, 283, 284, 286,
        288, 296, 303, 305, 307, 309, 310, 321, 325, 327, 328, 329, 344, 345,
        351, 352, 353, 370, 372, 373, 374, 378, 380, 384, 386, 387, 389, 407,
        410, 411, 417, 429, 432, 440, 447, 451, 452, 453, 457, 458, 459, 461,
        466, 469, 470, 471, 476, 477, 482, 489, 496, 501, 504, 517],
       device='cuda:3')
tensor([  8,  11,  12,  13,  15,  38,  40,  41,  47,  60,  65,  73,  96,  97,
         99, 105, 106, 113, 114, 117, 118, 119, 122, 123, 125, 129, 140, 141,
        152, 154, 155, 156, 160, 176, 179, 182, 184, 190, 191],
       device='cuda:3')
tensor([  9,  10,  11,  18,  19,  20,  21,  22,  24,  30,  37,  39,  40,  42,
         51,  67,  80,  96,  97, 101, 110, 112, 121, 130, 131, 141, 143, 167,
        175, 182, 187, 188, 191], device='cuda:3')
tensor([  5,   7,   8,  10,  12,  14,  18,  19,  20,  21,  35,  36,  37,  41,
         52,  53,  57,  86,  87,  90, 112, 113, 132, 178, 179, 186, 187],
       device='cuda:3')
tensor([  8,   9,  12,  14,  16,  20,  22,  30,  33,  34,  56,  61,  62,  67,
         70,  71,  72,  75,  76,  80,  81,  90,  98, 112, 140],
       device='cuda:3')
tensor([  8,   9,  14,  15,  16,  17,  23,  24,  26,  29,  36,  37,  39,  41,
         45,  46,  47,  50,  51,  55,  76,  79,  80,  81,  82,  83,  84,  87,
         90,  91,  92,  93,  97, 102, 103, 108, 112, 115, 121, 123, 126, 127,
        128, 147, 154, 164, 165, 168, 178, 179, 180, 181, 187, 194, 204, 211,
        215, 216, 219, 222, 228, 232, 234, 237, 238, 241, 242, 246, 248, 249,
        268, 272, 281, 314, 315, 318, 321, 322, 323, 324, 325, 329, 340, 341,
        342], device='cuda:3')
tensor([ 49,  62,  64,  76,  77,  84,  91,  96,  97, 121, 123, 130, 148, 149,
        166, 169, 179, 181, 189, 244, 248, 249, 255, 256, 273, 284],
       device='cuda:3')
tensor([ 14,  15,  16,  17,  18,  22,  23,  25,  31,  32,  33,  35,  37,  38,
         39,  42,  43,  45,  47,  48,  51,  55,  58,  71,  74,  82,  83,  88,
         95, 102, 103, 106, 107, 112, 113, 116, 119, 127, 128, 129, 130, 132,
        136, 147, 152, 167, 168, 175, 176, 177, 178, 179, 180, 181, 185, 192,
        197, 200, 201, 215, 221, 223, 224, 225, 226, 231, 240, 241, 243, 254,
        255, 256, 258, 263, 280, 282, 300], device='cuda:3')
tensor([ 74,  99, 100, 102, 104, 116, 117, 119, 120, 133, 135, 138, 139, 140,
        164, 170, 171, 212, 223, 254, 298, 330], device='cuda:3')
tensor([  9,  10,  11,  12,  13,  14,  17,  21,  22,  25,  26,  36,  58,  63,
         72, 112, 211, 224, 234, 243], device='cuda:3')
tensor([ 20,  22,  40,  65,  77, 133, 210, 219, 228, 275], device='cuda:3')
tensor([ 13,  29,  33,  41,  46,  64,  67,  72,  73,  81,  82,  94, 101, 105,
        121, 157, 170, 180, 185, 202, 228, 235, 240, 253, 256, 272, 277, 280,
        281], device='cuda:3')
tensor([  6,   7,   8,   9,  10,  12,  13,  14,  15,  16,  18,  19,  20,  24,
         26,  37,  39,  40,  41,  44,  59,  62,  70,  72,  75,  77,  86,  87,
         90,  95,  96,  97,  99, 118, 127, 139, 153, 224, 226, 237, 238, 270,
        278, 281], device='cuda:3')
tensor([  7,  43,  44,  79, 107, 120, 125, 136, 161, 179, 196, 263],
       device='cuda:3')
tensor([ 12,  41,  50,  61,  68,  88, 110, 126, 151, 164, 165, 183, 223, 306],
       device='cuda:3')
tensor([ 11,  23,  24,  26,  27,  28,  30,  35,  38,  39,  40,  48,  49,  75,
         76,  92, 117, 118, 214, 222, 248, 264, 267, 307], device='cuda:3')
tensor([  6,   7,   8,  11,  12,  25,  59,  60,  66,  95, 140, 176, 203, 297,
        307], device='cuda:3')
tensor([  8,   9,  10,  11,  12,  13,  14,  16,  17,  18,  19,  20,  22,  23,
         24,  25,  42,  43,  44,  61,  77,  86,  92,  95,  96, 102, 104, 112,
        115, 129, 132, 144, 157, 186, 196], device='cuda:3')
tensor([ 16,  17,  75,  82,  86,  90,  95, 104, 117, 140, 160, 221],
       device='cuda:3')
tensor([ 26,  27,  34, 113, 114, 119, 142, 150, 203], device='cuda:3')
tensor([ 13,  16,  17,  44,  46,  69,  72, 101, 123, 124, 129, 132, 133, 134,
        138, 141, 154, 179, 189, 216, 222], device='cuda:3')
tensor([ 17,  24,  25,  60,  85,  88, 131, 186, 194, 195, 210, 248],
       device='cuda:3')
tensor([ 12,  15,  21,  61,  83, 137], device='cuda:3')
tensor([  9,  37,  93, 113], device='cuda:3')
tensor([ 13,  57, 155, 206], device='cuda:3')
tensor([ 18,  20,  23,  25,  44,  46,  51,  60,  62, 100, 102, 158, 177, 179,
        237, 239, 263, 273, 275, 284, 289, 313, 332, 343, 348, 350, 355, 367,
        374, 384, 405, 407], device='cuda:3')
tensor([ 15,  21,  22,  24,  28,  30,  31,  32,  33,  34,  40,  47,  48,  50,
         58,  59,  61,  74,  80,  81,  83,  84,  86, 100, 109, 110, 122, 123,
        139, 140, 147, 155, 156, 169, 170, 182, 183, 193, 217, 221, 237, 248,
        259, 263, 267, 268, 272, 277, 288, 302, 322, 326, 333, 343, 346, 351,
        378, 384, 387, 398, 408, 409, 412, 414], device='cuda:3')
tensor([ 27,  37,  45,  54,  57,  68,  91,  94, 106, 109, 118, 126, 131, 141,
        157, 176, 187, 196, 202, 205, 212, 229, 247, 250, 253, 263, 269, 282,
        285, 288, 296, 298, 299, 308, 314, 317], device='cuda:3')
tensor([  7,   8,  15,  16,  17,  18,  30,  31,  36,  43,  44,  61,  82,  84,
         85,  97,  98, 118, 156, 157, 167, 168, 169, 192, 236, 246, 247, 374,
        408, 409], device='cuda:3')
tensor([], device='cuda:3', dtype=torch.int64)
tensor([  7,  20,  27,  86, 223], device='cuda:3')
tensor([ 15,  16,  18,  35,  36,  38,  71, 113, 139, 228, 278, 279],
       device='cuda:3')
tensor([ 29,  32,  36,  51,  71,  78,  82,  83,  91, 130, 133, 151, 160, 161,
        174, 185, 204, 229, 237, 246, 258, 269], device='cuda:3')
tensor(121, device='cuda:3')
  File "/data/data/arrv/ThinkTuning_v1/train.py", line 854, in <module>
    fire.Fire(main)
  File "/data/data/arrv/env/tv/lib/python3.12/site-packages/fire/core.py", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/tv/lib/python3.12/site-packages/fire/core.py", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/env/tv/lib/python3.12/site-packages/fire/core.py", line 684, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/ThinkTuning_v1/train.py", line 836, in main
    results = train(
              ^^^^^^
  File "/data/data/arrv/ThinkTuning_v1/train.py", line 388, in train
    outputs = think_tuner_step(batch, model=model, tokenizer=tokenizer)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/ThinkTuning_v1/src/think_tuner.py", line 275, in think_tuner_step
    total_gate_loss, total_reinforce_loss, total_nll_thought, logy = start_thinking(batch["input_ids"], outputs.last_hidden_state, logits,  batch["labels"], unreduced_loss, model, tokenizer)
                                                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/data/arrv/ThinkTuning_v1/src/think_tuner.py", line 173, in start_thinking
    if indices is not None and len(indices) >= 3:
       ^^^^^^^^^^^^
  File "/data/data/arrv/env/tv/lib/python3.12/site-packages/torch/_tensor.py", line 1021, in __len__
    raise TypeError("len() of a 0-d tensor")
TypeError: len() of a 0-d tensor
